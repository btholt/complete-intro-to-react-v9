<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/images/favicon.ico"/><title>Testing User Interaction – Complete Intro to React</title><meta name="description" content="Learn how to test a Contact page in React using Vitest and vitest-fetch-mock, a tool to simplify fetch mocking. The tutorial covers setting up mocks, rendering components with React Query&#x27;s QueryClientProvider, filling out form inputs, simulating user interactions, and verifying API requests, providing a comprehensive guide for beginner to job-ready React developers under guidance from Brian Holt, creator of the Complete Intro to React course, version 9."/><meta name="keywords" content="React testing,Vitest,vitest-fetch-mock,React Query,Contact form testing"/><meta name="og:description" content="Learn how to test a Contact page in React using Vitest and vitest-fetch-mock, a tool to simplify fetch mocking. The tutorial covers setting up mocks, rendering components with React Query&#x27;s QueryClientProvider, filling out form inputs, simulating user interactions, and verifying API requests, providing a comprehensive guide for beginner to job-ready React developers under guidance from Brian Holt, creator of the Complete Intro to React course, version 9."/><meta name="og:title" content="Testing User Interaction – Complete Intro to React"/><meta name="og:image" content="/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/2fea0762771cca66.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2fea0762771cca66.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-4e7214a60fad8e88.js" defer=""></script><script src="/_next/static/chunks/framework-ecc4130bc7a58a64.js" defer=""></script><script src="/_next/static/chunks/main-a6a08e1f60796d6f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8844ca430b4a38f8.js" defer=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-f133ec3e69124099.js" defer=""></script><script src="/_next/static/6cfMzZxR9Y4qzeGRDdjZd/_buildManifest.js" defer=""></script><script src="/_next/static/6cfMzZxR9Y4qzeGRDdjZd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Complete Intro to React</a></h1><div class="navbar-info"><a href="https://holt.fyi/react" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><p>Let&#39;s test the Contact page. It has a nice, simple user interaction. User puts their information in, we submit to the API, and we show them a submitted header. Let&#39;s test all of that.</p>
<p>First we need a helper function, vitest-fetch-mock. We don&#39;t <em>need</em> it because Vitest can do it, but I think it just makes things easier.</p>
<pre><code class="hljs language-bash">npm i -D vitest-fetch-mock@0.3.0
</code></pre><p>And now let&#39;s write the code</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@testing-library/react&quot;</span>;
<span class="hljs-keyword">import</span> { expect, test, vi } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vitest&quot;</span>;
<span class="hljs-keyword">import</span> createFetchMock <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vitest-fetch-mock&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">QueryClientProvider</span>, <span class="hljs-title class_">QueryClient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@tanstack/react-query&quot;</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Route</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../routes/contact.lazy&quot;</span>;

<span class="hljs-keyword">const</span> queryClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryClient</span>();

<span class="hljs-keyword">const</span> fetchMocker = <span class="hljs-title function_">createFetchMock</span>(vi);
fetchMocker.<span class="hljs-title function_">enableMocks</span>();

<span class="hljs-title function_">test</span>(<span class="hljs-string">&quot;can submit contact form&quot;</span>, <span class="hljs-title function_">async</span> () =&gt; {
  fetchMocker.<span class="hljs-title function_">mockResponse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;ok&quot;</span> }));
  <span class="hljs-keyword">const</span> screen = <span class="hljs-title function_">render</span>(
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">QueryClientProvider</span> <span class="hljs-attr">client</span>=<span class="hljs-string">{queryClient}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Route.options.component</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">QueryClientProvider</span>&gt;</span></span>
  );

  <span class="hljs-keyword">const</span> nameInput = screen.<span class="hljs-title function_">getByPlaceholderText</span>(<span class="hljs-string">&quot;Name&quot;</span>);
  <span class="hljs-keyword">const</span> emailInput = screen.<span class="hljs-title function_">getByPlaceholderText</span>(<span class="hljs-string">&quot;Email&quot;</span>);
  <span class="hljs-keyword">const</span> msgTextArea = screen.<span class="hljs-title function_">getByPlaceholderText</span>(<span class="hljs-string">&quot;Message&quot;</span>);

  <span class="hljs-keyword">const</span> testData = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Brian&quot;</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">&quot;test@example.com&quot;</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;This is a test message&quot;</span>,
  };

  nameInput.<span class="hljs-property">value</span> = testData.<span class="hljs-property">name</span>;
  emailInput.<span class="hljs-property">value</span> = testData.<span class="hljs-property">email</span>;
  msgTextArea.<span class="hljs-property">value</span> = testData.<span class="hljs-property">message</span>;

  <span class="hljs-keyword">const</span> btn = screen.<span class="hljs-title function_">getByRole</span>(<span class="hljs-string">&quot;button&quot;</span>);

  btn.<span class="hljs-title function_">click</span>();

  <span class="hljs-keyword">const</span> h3 = <span class="hljs-keyword">await</span> screen.<span class="hljs-title function_">findByRole</span>(<span class="hljs-string">&quot;heading&quot;</span>, { <span class="hljs-attr">level</span>: <span class="hljs-number">3</span> });

  <span class="hljs-title function_">expect</span>(h3.<span class="hljs-property">innerText</span>).<span class="hljs-title function_">toContain</span>(<span class="hljs-string">&quot;Submitted&quot;</span>);

  <span class="hljs-keyword">const</span> requests = fetchMocker.<span class="hljs-title function_">requests</span>();
  <span class="hljs-title function_">expect</span>(requests.<span class="hljs-property">length</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-number">1</span>);
  <span class="hljs-title function_">expect</span>(requests[<span class="hljs-number">0</span>].<span class="hljs-property">url</span>).<span class="hljs-title function_">toBe</span>(<span class="hljs-string">&quot;/api/contact&quot;</span>);
  <span class="hljs-title function_">expect</span>(fetchMocker).<span class="hljs-title function_">toHaveBeenCalledWith</span>(<span class="hljs-string">&quot;/api/contact&quot;</span>, {
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(testData),
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,
    },
    <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span>,
  });
});
</code></pre><ul>
<li>We need to wrap React Query with a query provider always or it doesn&#39;t work. In this case we can just make that part of the initial render.</li>
<li>You can pre-populate React Query with a valid cache and then test if your app uses that correctly. Totally valid way to test. In this case we want to make sure our endpoint is being posted to correctly (to make sure we record a contact)so we aren&#39;t doing that.</li>
<li><code>vi</code> is Vitest&#39;s spy library, similar to sinon.</li>
<li>vitest-fetch-mock is just a nice layer on top of vi. We could just use vi directly.</li>
<li>Notice we can just call <code>click</code> and it does all the things we&#39;d expect. Cool, right?</li>
<li>We then make some assertions that our h3 shows up correctly, that our API was called once, and that it was submitted to our API the way we expect it to. This may seem a bit implementation-oriented, and it is, but typically in a larger app we&#39;d have a library for calling our API and we&#39;d test that individually but we don&#39;t here so we&#39;re wrapping it all together.</li>
</ul>
</div><div class="lesson-links"><a href="/lessons/testing/basic-react-tests" class="prev">← Previous</a><a href="/lessons/testing/testing-custom-hooks" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg fill="none" height="auto" width="32" xmlns="http://www.w3.org/2000/svg" viewBox="0.254 0.25 500 451.95400000000006"><path d="M394.033.25h76.67L303.202 191.693l197.052 260.511h-154.29L225.118 294.205 86.844 452.204H10.127l179.16-204.77L.254.25H158.46l109.234 144.417zm-26.908 406.063h42.483L135.377 43.73h-45.59z" fill="var(--footer-icons)"></path></svg></a></li><li class="social"><a href="https://bsky.app/profile/brianholt.me"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -3.268 64 68.414" width="38" height="auto"><path fill="var(--footer-icons)" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805zm36.254 0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"></path></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Exercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul></footer></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"description":"Learn how to test a Contact page in React using Vitest and vitest-fetch-mock, a tool to simplify fetch mocking. The tutorial covers setting up mocks, rendering components with React Query's QueryClientProvider, filling out form inputs, simulating user interactions, and verifying API requests, providing a comprehensive guide for beginner to job-ready React developers under guidance from Brian Holt, creator of the Complete Intro to React course, version 9.","keywords":["React testing","Vitest","vitest-fetch-mock","React Query","Contact form testing"]},"html":"\u003cp\u003eLet\u0026#39;s test the Contact page. It has a nice, simple user interaction. User puts their information in, we submit to the API, and we show them a submitted header. Let\u0026#39;s test all of that.\u003c/p\u003e\n\u003cp\u003eFirst we need a helper function, vitest-fetch-mock. We don\u0026#39;t \u003cem\u003eneed\u003c/em\u003e it because Vitest can do it, but I think it just makes things easier.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpm i -D vitest-fetch-mock@0.3.0\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eAnd now let\u0026#39;s write the code\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { render } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@testing-library/react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { expect, test, vi } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;vitest\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e createFetchMock \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;vitest-fetch-mock\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eQueryClientProvider\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eQueryClient\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;@tanstack/react-query\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { \u003cspan class=\"hljs-title class_\"\u003eRoute\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;../routes/contact.lazy\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e queryClient = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eQueryClient\u003c/span\u003e();\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e fetchMocker = \u003cspan class=\"hljs-title function_\"\u003ecreateFetchMock\u003c/span\u003e(vi);\nfetchMocker.\u003cspan class=\"hljs-title function_\"\u003eenableMocks\u003c/span\u003e();\n\n\u003cspan class=\"hljs-title function_\"\u003etest\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;can submit contact form\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003easync\u003c/span\u003e () =\u0026gt; {\n  fetchMocker.\u003cspan class=\"hljs-title function_\"\u003emockResponse\u003c/span\u003e(\u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003estringify\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003estatus\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;ok\u0026quot;\u003c/span\u003e }));\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e screen = \u003cspan class=\"hljs-title function_\"\u003erender\u003c/span\u003e(\n    \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eQueryClientProvider\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclient\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{queryClient}\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eRoute.options.component\u003c/span\u003e /\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eQueryClientProvider\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  );\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e nameInput = screen.\u003cspan class=\"hljs-title function_\"\u003egetByPlaceholderText\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Name\u0026quot;\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e emailInput = screen.\u003cspan class=\"hljs-title function_\"\u003egetByPlaceholderText\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Email\u0026quot;\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e msgTextArea = screen.\u003cspan class=\"hljs-title function_\"\u003egetByPlaceholderText\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Message\u0026quot;\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e testData = {\n    \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;Brian\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eemail\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;test@example.com\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003emessage\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;This is a test message\u0026quot;\u003c/span\u003e,\n  };\n\n  nameInput.\u003cspan class=\"hljs-property\"\u003evalue\u003c/span\u003e = testData.\u003cspan class=\"hljs-property\"\u003ename\u003c/span\u003e;\n  emailInput.\u003cspan class=\"hljs-property\"\u003evalue\u003c/span\u003e = testData.\u003cspan class=\"hljs-property\"\u003eemail\u003c/span\u003e;\n  msgTextArea.\u003cspan class=\"hljs-property\"\u003evalue\u003c/span\u003e = testData.\u003cspan class=\"hljs-property\"\u003emessage\u003c/span\u003e;\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e btn = screen.\u003cspan class=\"hljs-title function_\"\u003egetByRole\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e);\n\n  btn.\u003cspan class=\"hljs-title function_\"\u003eclick\u003c/span\u003e();\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e h3 = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e screen.\u003cspan class=\"hljs-title function_\"\u003efindByRole\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;heading\u0026quot;\u003c/span\u003e, { \u003cspan class=\"hljs-attr\"\u003elevel\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e });\n\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(h3.\u003cspan class=\"hljs-property\"\u003einnerText\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003etoContain\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Submitted\u0026quot;\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e requests = fetchMocker.\u003cspan class=\"hljs-title function_\"\u003erequests\u003c/span\u003e();\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(requests.\u003cspan class=\"hljs-property\"\u003elength\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(requests[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e].\u003cspan class=\"hljs-property\"\u003eurl\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003etoBe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/api/contact\u0026quot;\u003c/span\u003e);\n  \u003cspan class=\"hljs-title function_\"\u003eexpect\u003c/span\u003e(fetchMocker).\u003cspan class=\"hljs-title function_\"\u003etoHaveBeenCalledWith\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/api/contact\u0026quot;\u003c/span\u003e, {\n    \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003estringify\u003c/span\u003e(testData),\n    \u003cspan class=\"hljs-attr\"\u003eheaders\u003c/span\u003e: {\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Content-Type\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e,\n    },\n    \u003cspan class=\"hljs-attr\"\u003emethod\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e,\n  });\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eWe need to wrap React Query with a query provider always or it doesn\u0026#39;t work. In this case we can just make that part of the initial render.\u003c/li\u003e\n\u003cli\u003eYou can pre-populate React Query with a valid cache and then test if your app uses that correctly. Totally valid way to test. In this case we want to make sure our endpoint is being posted to correctly (to make sure we record a contact)so we aren\u0026#39;t doing that.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003evi\u003c/code\u003e is Vitest\u0026#39;s spy library, similar to sinon.\u003c/li\u003e\n\u003cli\u003evitest-fetch-mock is just a nice layer on top of vi. We could just use vi directly.\u003c/li\u003e\n\u003cli\u003eNotice we can just call \u003ccode\u003eclick\u003c/code\u003e and it does all the things we\u0026#39;d expect. Cool, right?\u003c/li\u003e\n\u003cli\u003eWe then make some assertions that our h3 shows up correctly, that our API was called once, and that it was submitted to our API the way we expect it to. This may seem a bit implementation-oriented, and it is, but typically in a larger app we\u0026#39;d have a library for calling our API and we\u0026#39;d test that individually but we don\u0026#39;t here so we\u0026#39;re wrapping it all together.\u003c/li\u003e\n\u003c/ul\u003e\n","markdown":"Let's test the Contact page. It has a nice, simple user interaction. User puts their information in, we submit to the API, and we show them a submitted header. Let's test all of that.\n\nFirst we need a helper function, vitest-fetch-mock. We don't _need_ it because Vitest can do it, but I think it just makes things easier.\n\n```bash\nnpm i -D vitest-fetch-mock@0.3.0\n```\n\nAnd now let's write the code\n\n```javascript\nimport { render } from \"@testing-library/react\";\nimport { expect, test, vi } from \"vitest\";\nimport createFetchMock from \"vitest-fetch-mock\";\nimport { QueryClientProvider, QueryClient } from \"@tanstack/react-query\";\nimport { Route } from \"../routes/contact.lazy\";\n\nconst queryClient = new QueryClient();\n\nconst fetchMocker = createFetchMock(vi);\nfetchMocker.enableMocks();\n\ntest(\"can submit contact form\", async () =\u003e {\n  fetchMocker.mockResponse(JSON.stringify({ status: \"ok\" }));\n  const screen = render(\n    \u003cQueryClientProvider client={queryClient}\u003e\n      \u003cRoute.options.component /\u003e\n    \u003c/QueryClientProvider\u003e\n  );\n\n  const nameInput = screen.getByPlaceholderText(\"Name\");\n  const emailInput = screen.getByPlaceholderText(\"Email\");\n  const msgTextArea = screen.getByPlaceholderText(\"Message\");\n\n  const testData = {\n    name: \"Brian\",\n    email: \"test@example.com\",\n    message: \"This is a test message\",\n  };\n\n  nameInput.value = testData.name;\n  emailInput.value = testData.email;\n  msgTextArea.value = testData.message;\n\n  const btn = screen.getByRole(\"button\");\n\n  btn.click();\n\n  const h3 = await screen.findByRole(\"heading\", { level: 3 });\n\n  expect(h3.innerText).toContain(\"Submitted\");\n\n  const requests = fetchMocker.requests();\n  expect(requests.length).toBe(1);\n  expect(requests[0].url).toBe(\"/api/contact\");\n  expect(fetchMocker).toHaveBeenCalledWith(\"/api/contact\", {\n    body: JSON.stringify(testData),\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    method: \"POST\",\n  });\n});\n```\n\n- We need to wrap React Query with a query provider always or it doesn't work. In this case we can just make that part of the initial render.\n- You can pre-populate React Query with a valid cache and then test if your app uses that correctly. Totally valid way to test. In this case we want to make sure our endpoint is being posted to correctly (to make sure we record a contact)so we aren't doing that.\n- `vi` is Vitest's spy library, similar to sinon.\n- vitest-fetch-mock is just a nice layer on top of vi. We could just use vi directly.\n- Notice we can just call `click` and it does all the things we'd expect. Cool, right?\n- We then make some assertions that our h3 shows up correctly, that our API was called once, and that it was submitted to our API the way we expect it to. This may seem a bit implementation-oriented, and it is, but typically in a larger app we'd have a library for calling our API and we'd test that individually but we don't here so we're wrapping it all together.\n","slug":"testing-user-interaction","title":"Testing User Interaction","section":"Testing","icon":"vial","filePath":"/home/runner/work/complete-intro-to-react-v9/complete-intro-to-react-v9/lessons/07-testing/C-testing-user-interaction.md","nextSlug":"/lessons/testing/testing-custom-hooks","prevSlug":"/lessons/testing/basic-react-tests"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"testing","slug":"testing-user-interaction"},"buildId":"6cfMzZxR9Y4qzeGRDdjZd","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>