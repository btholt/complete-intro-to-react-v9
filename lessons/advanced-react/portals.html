<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/images/favicon.ico"/><title>Portals – Complete Intro to React</title><meta name="description" content="Learn how to implement a React modal using portals for rendering components outside the main app structure in Brian Holt&#x27;s &quot;Complete Intro to React.&quot; This guide covers use of React Query for asynchronous data management and demonstrates best practices in creating user interface elements like modals to improve web development skills. Ideal for React developers seeking practical experience with advanced rendering techniques and API integration."/><meta name="keywords" content="React modals,portals,React Query,web development,Brian Holt"/><meta name="og:description" content="Learn how to implement a React modal using portals for rendering components outside the main app structure in Brian Holt&#x27;s &quot;Complete Intro to React.&quot; This guide covers use of React Query for asynchronous data management and demonstrates best practices in creating user interface elements like modals to improve web development skills. Ideal for React developers seeking practical experience with advanced rendering techniques and API integration."/><meta name="og:title" content="Portals – Complete Intro to React"/><meta name="og:image" content="/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/2fea0762771cca66.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2fea0762771cca66.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-4e7214a60fad8e88.js" defer=""></script><script src="/_next/static/chunks/framework-ecc4130bc7a58a64.js" defer=""></script><script src="/_next/static/chunks/main-a6a08e1f60796d6f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8844ca430b4a38f8.js" defer=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-f133ec3e69124099.js" defer=""></script><script src="/_next/static/6cfMzZxR9Y4qzeGRDdjZd/_buildManifest.js" defer=""></script><script src="/_next/static/6cfMzZxR9Y4qzeGRDdjZd/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Complete Intro to React</a></h1><div class="navbar-info"><a href="https://holt.fyi/react" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><h2>Portals</h2>
<p>What if you are rendering a page and you want to render something in another part of the page at the same time? Think like you have a contextual right navigation and you have a page that wants to render into the contextual nav. We could use something like context to do that and that would be totally acceptable. But there&#39;s another cool way called a portal to do this as well. It even lets us render outside our app totally, like we&#39;re about to do.</p>
<p>We&#39;re going to do a modal or a &quot;popover&quot;. I think these are bad user experiences but it&#39;s a perfect use case for a portal so we&#39;re going to do it! In our case, because we want the modal to render in front of everything, we need the div that the modal renders into to be first in the DOM. So let&#39;s go make a div that does that. Open your index.html file and put this in there.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// above #root</span>
&lt;div id=<span class="hljs-string">&quot;modal&quot;</span>&gt;&lt;/div&gt;
</code></pre><p>By default this will have nothing in it, but once we render our modal it render inside this div instead of root. Make a new file in src called Modal.jsx</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// basically stolen from the React docs</span>
<span class="hljs-keyword">import</span> { useEffect, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { createPortal } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Modal</span> = (<span class="hljs-params">{ children }</span>) =&gt; {
  <span class="hljs-keyword">const</span> elRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">if</span> (!elRef.<span class="hljs-property">current</span>) {
    elRef.<span class="hljs-property">current</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);
  }

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> modalRoot = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;modal&quot;</span>);
    modalRoot.<span class="hljs-title function_">appendChild</span>(elRef.<span class="hljs-property">current</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> modalRoot.<span class="hljs-title function_">removeChild</span>(elRef.<span class="hljs-property">current</span>);
  }, []);

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createPortal</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>, elRef.<span class="hljs-property">current</span>);
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Modal</span>;
</code></pre><ul>
<li>This uses a ref. A ref is a reference to something that need to be exactly the same between renders. A hook would get regenerated / recreated so we need a ref because it&#39;ll create a div and then it hand back the <em>same</em> div every render. It&#39;s important that it&#39;s the same div because it&#39;ll be the one we use to render the portal.</li>
<li>We&#39;re using createPortal to render into this new modal div we&#39;re chosen for our modal. But this could be a contextual nav or any other DOM div we want.</li>
<li>We use the returned function on the effect to clean up when this Modal is unmounted from the DOM. Otherwise we&#39;d leak memory.</li>
</ul>
<p>Before we use our Modal, we&#39;ll need to make another API call function get a past order. In our example here, we&#39;re going to make it so you can click on one of the rows in our past orders page to see what was in the order. In <code>src/api</code>, add a file called <code>getPastOrder.js</code> (no <code>s</code>) and add this.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getPastOrder</span>(<span class="hljs-params">order</span>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/past-order/<span class="hljs-subst">${order}</span>`</span>);
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
  <span class="hljs-keyword">return</span> data;
}
</code></pre><p>Then render the modal if we have a <code>focusedOrder</code>: </p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// import at top</span>
<span class="hljs-keyword">import</span> getPastOrder <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../api/getPastOrder&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Modal</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../Modal&quot;</span>;

<span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> In the course, Brian makes this a hook/module</span>
<span class="hljs-keyword">const</span> intl = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intl</span>.<span class="hljs-title class_">NumberFormat</span>(<span class="hljs-string">&quot;en-US&quot;</span>, {
  <span class="hljs-attr">style</span>: <span class="hljs-string">&quot;currency&quot;</span>,
  <span class="hljs-attr">currency</span>: <span class="hljs-string">&quot;USD&quot;</span>,
});

<span class="hljs-comment">// top of the render function</span>
<span class="hljs-keyword">const</span> [focusedOrder, setFocusedOrder] = <span class="hljs-title function_">useState</span>();

<span class="hljs-keyword">const</span> { <span class="hljs-attr">isLoading</span>: isLoadingPastOrder, <span class="hljs-attr">data</span>: pastOrderData } = <span class="hljs-title function_">useQuery</span>({
  <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">&quot;past-order&quot;</span>, focusedOrder],
  <span class="hljs-attr">queryFn</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">getPastOrder</span>(focusedOrder),
  <span class="hljs-attr">enabled</span>: !!focusedOrder,
  <span class="hljs-attr">staleTime</span>: <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// one day in milliseconds,</span>
});

<span class="hljs-comment">// last thing before closing div</span>
{
  focusedOrder ? (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Modal</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Order #{focusedOrder}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      {!isLoadingPastOrder ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Image<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Size<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Quantity<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Price<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Total<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
            {pastOrderData.orderItems.map((pizza) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{</span>`${<span class="hljs-attr">pizza.pizzaTypeId</span>}<span class="hljs-attr">_</span>${<span class="hljs-attr">pizza.size</span>}`}&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{pizza.image}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{pizza.name}</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{pizza.name}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{pizza.size}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{pizza.quantity}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{intl.format(pizza.price)}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{intl.format(pizza.total)}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Loading …<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      )}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFocusedOrder()}&gt;Close<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span></span>
  ) : <span class="hljs-literal">null</span>
}
</code></pre><ul>
<li>We&#39;re using React Query again here. We&#39;re using the <code>enabled</code> key to only make this request when the user has set a focusedOrder. If there&#39;s no focusedOrder, then it won&#39;t make the request. <code>!!</code> is the same as &quot;not not&quot;. It makes a number like <code>5</code> be <code>true</code> and a number like <code>0</code> or <code>undefined</code> be <code>false</code>.</li>
<li>We set the staleTime to day. These orders shouldn&#39;t change very frequently.</li>
<li>If there&#39;s no focusedOrder, we don&#39;t render the Modal, which means the portal is unused.</li>
<li>If there is a focusedOrder, we render the modal and show a loading indicator that we&#39;re loading the rest of the info.</li>
<li>When a user clicks Close, we set the focusedOrder to be undefined again which causes the Modal to unrender.</li>
</ul>
<p>Finally, we need a way to open the modal. Open <code>past.lazy.jsx</code>. Make the <code>order.order_id</code> value a button and add an <code>onClick</code> event so clicking it will open the Modal:</p>
<pre><code class="hljs language-javascript">&lt;td&gt;
  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFocusedOrder(order.order_id)}&gt;
    {order.order_id}
  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
&lt;/td&gt;
<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{order.date}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span>
<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{order.time}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span></span>
</code></pre><p>That&#39;s it!</p>
<blockquote>
<p>🏁 <a href="https://github.com/btholt/citr-v9-project/tree/master/11-modals">Click here to see the state of the project up until now: 11-modals</a></p>
</blockquote>
</div><div class="lesson-links"><a href="/lessons/ecosystem/tanstack-query" class="prev">← Previous</a><a href="/lessons/advanced-react/error-boundaries" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg fill="none" height="auto" width="32" xmlns="http://www.w3.org/2000/svg" viewBox="0.254 0.25 500 451.95400000000006"><path d="M394.033.25h76.67L303.202 191.693l197.052 260.511h-154.29L225.118 294.205 86.844 452.204H10.127l179.16-204.77L.254.25H158.46l109.234 144.417zm-26.908 406.063h42.483L135.377 43.73h-45.59z" fill="var(--footer-icons)"></path></svg></a></li><li class="social"><a href="https://bsky.app/profile/brianholt.me"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -3.268 64 68.414" width="38" height="auto"><path fill="var(--footer-icons)" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805zm36.254 0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"></path></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Exercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul></footer></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"description":"Learn how to implement a React modal using portals for rendering components outside the main app structure in Brian Holt's \"Complete Intro to React.\" This guide covers use of React Query for asynchronous data management and demonstrates best practices in creating user interface elements like modals to improve web development skills. Ideal for React developers seeking practical experience with advanced rendering techniques and API integration.","keywords":["React modals","portals","React Query","web development","Brian Holt"]},"html":"\u003ch2\u003ePortals\u003c/h2\u003e\n\u003cp\u003eWhat if you are rendering a page and you want to render something in another part of the page at the same time? Think like you have a contextual right navigation and you have a page that wants to render into the contextual nav. We could use something like context to do that and that would be totally acceptable. But there\u0026#39;s another cool way called a portal to do this as well. It even lets us render outside our app totally, like we\u0026#39;re about to do.\u003c/p\u003e\n\u003cp\u003eWe\u0026#39;re going to do a modal or a \u0026quot;popover\u0026quot;. I think these are bad user experiences but it\u0026#39;s a perfect use case for a portal so we\u0026#39;re going to do it! In our case, because we want the modal to render in front of everything, we need the div that the modal renders into to be first in the DOM. So let\u0026#39;s go make a div that does that. Open your index.html file and put this in there.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// above #root\u003c/span\u003e\n\u0026lt;div id=\u003cspan class=\"hljs-string\"\u003e\u0026quot;modal\u0026quot;\u003c/span\u003e\u0026gt;\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eBy default this will have nothing in it, but once we render our modal it render inside this div instead of root. Make a new file in src called Modal.jsx\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// basically stolen from the React docs\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { useEffect, useRef } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { createPortal } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react-dom\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eModal\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e{ children }\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e elRef = \u003cspan class=\"hljs-title function_\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e) {\n    elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecreateElement\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;div\u0026quot;\u003c/span\u003e);\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e modalRoot = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;modal\u0026quot;\u003c/span\u003e);\n    modalRoot.\u003cspan class=\"hljs-title function_\"\u003eappendChild\u003c/span\u003e(elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e modalRoot.\u003cspan class=\"hljs-title function_\"\u003eremoveChild\u003c/span\u003e(elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e);\n  }, []);\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecreatePortal\u003c/span\u003e(\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e{children}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e, elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e);\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eModal\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eThis uses a ref. A ref is a reference to something that need to be exactly the same between renders. A hook would get regenerated / recreated so we need a ref because it\u0026#39;ll create a div and then it hand back the \u003cem\u003esame\u003c/em\u003e div every render. It\u0026#39;s important that it\u0026#39;s the same div because it\u0026#39;ll be the one we use to render the portal.\u003c/li\u003e\n\u003cli\u003eWe\u0026#39;re using createPortal to render into this new modal div we\u0026#39;re chosen for our modal. But this could be a contextual nav or any other DOM div we want.\u003c/li\u003e\n\u003cli\u003eWe use the returned function on the effect to clean up when this Modal is unmounted from the DOM. Otherwise we\u0026#39;d leak memory.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBefore we use our Modal, we\u0026#39;ll need to make another API call function get a past order. In our example here, we\u0026#39;re going to make it so you can click on one of the rows in our past orders page to see what was in the order. In \u003ccode\u003esrc/api\u003c/code\u003e, add a file called \u003ccode\u003egetPastOrder.js\u003c/code\u003e (no \u003ccode\u003es\u003c/code\u003e) and add this.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetPastOrder\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eorder\u003c/span\u003e) {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e response = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003efetch\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`/api/past-order/\u003cspan class=\"hljs-subst\"\u003e${order}\u003c/span\u003e`\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e data = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e response.\u003cspan class=\"hljs-title function_\"\u003ejson\u003c/span\u003e();\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e data;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThen render the modal if we have a \u003ccode\u003efocusedOrder\u003c/code\u003e: \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// import at top\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e getPastOrder \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;../api/getPastOrder\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eModal\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;../Modal\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment\"\u003e// \u003cspan class=\"hljs-doctag\"\u003eNOTE:\u003c/span\u003e In the course, Brian makes this a hook/module\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e intl = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eIntl\u003c/span\u003e.\u003cspan class=\"hljs-title class_\"\u003eNumberFormat\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;en-US\u0026quot;\u003c/span\u003e, {\n  \u003cspan class=\"hljs-attr\"\u003estyle\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;currency\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003ecurrency\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;USD\u0026quot;\u003c/span\u003e,\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// top of the render function\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e [focusedOrder, setFocusedOrder] = \u003cspan class=\"hljs-title function_\"\u003euseState\u003c/span\u003e();\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { \u003cspan class=\"hljs-attr\"\u003eisLoading\u003c/span\u003e: isLoadingPastOrder, \u003cspan class=\"hljs-attr\"\u003edata\u003c/span\u003e: pastOrderData } = \u003cspan class=\"hljs-title function_\"\u003euseQuery\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003equeryKey\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026quot;past-order\u0026quot;\u003c/span\u003e, focusedOrder],\n  \u003cspan class=\"hljs-attr\"\u003equeryFn\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetPastOrder\u003c/span\u003e(focusedOrder),\n  \u003cspan class=\"hljs-attr\"\u003eenabled\u003c/span\u003e: !!focusedOrder,\n  \u003cspan class=\"hljs-attr\"\u003estaleTime\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e60\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// one day in milliseconds,\u003c/span\u003e\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// last thing before closing div\u003c/span\u003e\n{\n  focusedOrder ? (\n    \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eModal\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eh2\u003c/span\u003e\u0026gt;\u003c/span\u003eOrder #{focusedOrder}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eh2\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      {!isLoadingPastOrder ? (\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etable\u003c/span\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ethead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etr\u003c/span\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003eImage\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003eName\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003eSize\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003eQuantity\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003ePrice\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003eTotal\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etr\u003c/span\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ethead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etbody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            {pastOrderData.orderItems.map((pizza) =\u0026gt; (\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etr\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{\u003c/span\u003e`${\u003cspan class=\"hljs-attr\"\u003epizza.pizzaTypeId\u003c/span\u003e}\u003cspan class=\"hljs-attr\"\u003e_\u003c/span\u003e${\u003cspan class=\"hljs-attr\"\u003epizza.size\u003c/span\u003e}`}\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eimg\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{pizza.image}\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ealt\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{pizza.name}\u003c/span\u003e /\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e{pizza.name}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e{pizza.size}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e{pizza.quantity}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e{intl.format(pizza.price)}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e{intl.format(pizza.total)}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etr\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            ))}\n          \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etbody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etable\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      ) : (\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003eLoading …\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      )}\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{()\u003c/span\u003e =\u0026gt;\u003c/span\u003e setFocusedOrder()}\u0026gt;Close\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eModal\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  ) : \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eWe\u0026#39;re using React Query again here. We\u0026#39;re using the \u003ccode\u003eenabled\u003c/code\u003e key to only make this request when the user has set a focusedOrder. If there\u0026#39;s no focusedOrder, then it won\u0026#39;t make the request. \u003ccode\u003e!!\u003c/code\u003e is the same as \u0026quot;not not\u0026quot;. It makes a number like \u003ccode\u003e5\u003c/code\u003e be \u003ccode\u003etrue\u003c/code\u003e and a number like \u003ccode\u003e0\u003c/code\u003e or \u003ccode\u003eundefined\u003c/code\u003e be \u003ccode\u003efalse\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eWe set the staleTime to day. These orders shouldn\u0026#39;t change very frequently.\u003c/li\u003e\n\u003cli\u003eIf there\u0026#39;s no focusedOrder, we don\u0026#39;t render the Modal, which means the portal is unused.\u003c/li\u003e\n\u003cli\u003eIf there is a focusedOrder, we render the modal and show a loading indicator that we\u0026#39;re loading the rest of the info.\u003c/li\u003e\n\u003cli\u003eWhen a user clicks Close, we set the focusedOrder to be undefined again which causes the Modal to unrender.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFinally, we need a way to open the modal. Open \u003ccode\u003epast.lazy.jsx\u003c/code\u003e. Make the \u003ccode\u003eorder.order_id\u003c/code\u003e value a button and add an \u003ccode\u003eonClick\u003c/code\u003e event so clicking it will open the Modal:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u0026lt;td\u0026gt;\n  \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{()\u003c/span\u003e =\u0026gt;\u003c/span\u003e setFocusedOrder(order.order_id)}\u0026gt;\n    {order.order_id}\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u0026lt;/td\u0026gt;\n\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e{order.date}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e{order.time}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etd\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThat\u0026#39;s it!\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e🏁 \u003ca href=\"https://github.com/btholt/citr-v9-project/tree/master/11-modals\"\u003eClick here to see the state of the project up until now: 11-modals\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n","markdown":"\n## Portals\n\nWhat if you are rendering a page and you want to render something in another part of the page at the same time? Think like you have a contextual right navigation and you have a page that wants to render into the contextual nav. We could use something like context to do that and that would be totally acceptable. But there's another cool way called a portal to do this as well. It even lets us render outside our app totally, like we're about to do.\n\nWe're going to do a modal or a \"popover\". I think these are bad user experiences but it's a perfect use case for a portal so we're going to do it! In our case, because we want the modal to render in front of everything, we need the div that the modal renders into to be first in the DOM. So let's go make a div that does that. Open your index.html file and put this in there.\n\n```javascript\n// above #root\n\u003cdiv id=\"modal\"\u003e\u003c/div\u003e\n```\n\nBy default this will have nothing in it, but once we render our modal it render inside this div instead of root. Make a new file in src called Modal.jsx\n\n```javascript\n// basically stolen from the React docs\nimport { useEffect, useRef } from \"react\";\nimport { createPortal } from \"react-dom\";\n\nconst Modal = ({ children }) =\u003e {\n  const elRef = useRef(null);\n  if (!elRef.current) {\n    elRef.current = document.createElement(\"div\");\n  }\n\n  useEffect(() =\u003e {\n    const modalRoot = document.getElementById(\"modal\");\n    modalRoot.appendChild(elRef.current);\n    return () =\u003e modalRoot.removeChild(elRef.current);\n  }, []);\n\n  return createPortal(\u003cdiv\u003e{children}\u003c/div\u003e, elRef.current);\n};\n\nexport default Modal;\n```\n\n- This uses a ref. A ref is a reference to something that need to be exactly the same between renders. A hook would get regenerated / recreated so we need a ref because it'll create a div and then it hand back the _same_ div every render. It's important that it's the same div because it'll be the one we use to render the portal.\n- We're using createPortal to render into this new modal div we're chosen for our modal. But this could be a contextual nav or any other DOM div we want.\n- We use the returned function on the effect to clean up when this Modal is unmounted from the DOM. Otherwise we'd leak memory.\n\nBefore we use our Modal, we'll need to make another API call function get a past order. In our example here, we're going to make it so you can click on one of the rows in our past orders page to see what was in the order. In `src/api`, add a file called `getPastOrder.js` (no `s`) and add this.\n\n```javascript\nexport default async function getPastOrder(order) {\n  const response = await fetch(`/api/past-order/${order}`);\n  const data = await response.json();\n  return data;\n}\n```\n\nThen render the modal if we have a `focusedOrder`: \n\n```javascript\n// import at top\nimport getPastOrder from \"../api/getPastOrder\";\nimport Modal from \"../Modal\";\n\n// NOTE: In the course, Brian makes this a hook/module\nconst intl = new Intl.NumberFormat(\"en-US\", {\n  style: \"currency\",\n  currency: \"USD\",\n});\n\n// top of the render function\nconst [focusedOrder, setFocusedOrder] = useState();\n\nconst { isLoading: isLoadingPastOrder, data: pastOrderData } = useQuery({\n  queryKey: [\"past-order\", focusedOrder],\n  queryFn: () =\u003e getPastOrder(focusedOrder),\n  enabled: !!focusedOrder,\n  staleTime: 24 * 60 * 60 * 1000, // one day in milliseconds,\n});\n\n// last thing before closing div\n{\n  focusedOrder ? (\n    \u003cModal\u003e\n      \u003ch2\u003eOrder #{focusedOrder}\u003c/h2\u003e\n      {!isLoadingPastOrder ? (\n        \u003ctable\u003e\n          \u003cthead\u003e\n            \u003ctr\u003e\n              \u003ctd\u003eImage\u003c/td\u003e\n              \u003ctd\u003eName\u003c/td\u003e\n              \u003ctd\u003eSize\u003c/td\u003e\n              \u003ctd\u003eQuantity\u003c/td\u003e\n              \u003ctd\u003ePrice\u003c/td\u003e\n              \u003ctd\u003eTotal\u003c/td\u003e\n            \u003c/tr\u003e\n          \u003c/thead\u003e\n          \u003ctbody\u003e\n            {pastOrderData.orderItems.map((pizza) =\u003e (\n              \u003ctr key={`${pizza.pizzaTypeId}_${pizza.size}`}\u003e\n                \u003ctd\u003e\n                  \u003cimg src={pizza.image} alt={pizza.name} /\u003e\n                \u003c/td\u003e\n                \u003ctd\u003e{pizza.name}\u003c/td\u003e\n                \u003ctd\u003e{pizza.size}\u003c/td\u003e\n                \u003ctd\u003e{pizza.quantity}\u003c/td\u003e\n                \u003ctd\u003e{intl.format(pizza.price)}\u003c/td\u003e\n                \u003ctd\u003e{intl.format(pizza.total)}\u003c/td\u003e\n              \u003c/tr\u003e\n            ))}\n          \u003c/tbody\u003e\n        \u003c/table\u003e\n      ) : (\n        \u003cp\u003eLoading …\u003c/p\u003e\n      )}\n      \u003cbutton onClick={() =\u003e setFocusedOrder()}\u003eClose\u003c/button\u003e\n    \u003c/Modal\u003e\n  ) : null\n}\n```\n\n- We're using React Query again here. We're using the `enabled` key to only make this request when the user has set a focusedOrder. If there's no focusedOrder, then it won't make the request. `!!` is the same as \"not not\". It makes a number like `5` be `true` and a number like `0` or `undefined` be `false`.\n- We set the staleTime to day. These orders shouldn't change very frequently.\n- If there's no focusedOrder, we don't render the Modal, which means the portal is unused.\n- If there is a focusedOrder, we render the modal and show a loading indicator that we're loading the rest of the info.\n- When a user clicks Close, we set the focusedOrder to be undefined again which causes the Modal to unrender.\n\nFinally, we need a way to open the modal. Open `past.lazy.jsx`. Make the `order.order_id` value a button and add an `onClick` event so clicking it will open the Modal:\n\n```javascript\n\u003ctd\u003e\n  \u003cbutton onClick={() =\u003e setFocusedOrder(order.order_id)}\u003e\n    {order.order_id}\n  \u003c/button\u003e\n\u003c/td\u003e\n\u003ctd\u003e{order.date}\u003c/td\u003e\n\u003ctd\u003e{order.time}\u003c/td\u003e\n```\n\n\nThat's it!\n\n\u003e 🏁 [Click here to see the state of the project up until now: 11-modals][step]\n\n[step]: https://github.com/btholt/citr-v9-project/tree/master/11-modals\n","slug":"portals","title":"Portals","section":"Advanced React","icon":"dumbbell","filePath":"/home/runner/work/complete-intro-to-react-v9/complete-intro-to-react-v9/lessons/06-advanced-react/A-portals.md","nextSlug":"/lessons/advanced-react/error-boundaries","prevSlug":"/lessons/ecosystem/tanstack-query"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"advanced-react","slug":"portals"},"buildId":"6cfMzZxR9Y4qzeGRDdjZd","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>