{"pageProps":{"post":{"attributes":{"description":"Learn how to upgrade your application to React 19 and simplify form handling in this segment of Brian Holt‚Äôs Complete Intro to React, version 9. Discover new React form actions, \"use server\" directives for server-side logic, and useFormData hooks to manage input states effectively. Ideal for React developers seeking practical techniques to streamline their web applications.","keywords":["React 19","form actions","useFormData","Brian Holt","React upgrade"]},"html":"<h2>Form Actions</h2>\n<p>Okay, so let&#39;s actually upgrade our app to be React 19.</p>\n<blockquote>\n<p>üö® Pay attention here, as you need to figure out which version of React to install.</p>\n</blockquote>\n<p><a href=\"https://www.npmjs.com/package/react?activeTab=versions\">Go here</a> and look at the versions of React published on npm. If you see that React 19 is still in canary/rc/next (which are all the same) then you can run <code>npm i react@rc react-dom@rc</code>. You&#39;ll get a lot of warnings about things not matching versions in your command-line, that&#39;s totally okay.</p>\n<p>If React 19 is latest, then run <code>npm install react@19 react-dom@19</code> and then follow these instructions. Be extra cautious because things may have changed!!</p>\n<p>Okay, let&#39;s talk form actions. A lot of web interfaces is just handling form inputs, and so the React team decided to make it easier to do that. It&#39;s actually really similar to what we&#39;ve done already, just a little less boilerplate. Open your contact.lazy.jsx and let&#39;s modify this page to use a form action.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-attr\">mutationFn</span>: <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">formData</span>) { <span class=\"hljs-comment\">// change to formData</span>\n  <span class=\"hljs-comment\">// remove e.preventDefault</span>\n  <span class=\"hljs-comment\">// remove formData constructor</span>\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">postContact</span>(\n    formData.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;name&quot;</span>),\n    formData.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;email&quot;</span>),\n    formData.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;message&quot;</span>),\n  );\n},\n\n<span class=\"hljs-comment\">// change onSubmit to action</span>\n<span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">form</span> <span class=\"hljs-attr\">action</span>=<span class=\"hljs-string\">{mutation.mutate}</span>&gt;</span></span>\n</code></pre><p>That&#39;s it! It really is just a convenience function to make handling for submits even easier to do. There&#39;s nothing wrong with what we had either, and that will continue to work as-is too.</p>\n<p>Let&#39;s go convert <code>order.lazy.jsx</code> too</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">// extract submission function from form</span>\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">addToCart</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-title function_\">setCart</span>([...cart, { <span class=\"hljs-attr\">pizza</span>: selectedPizza, <span class=\"hljs-attr\">size</span>: pizzaSize, price }]);\n}\n<span class=\"hljs-comment\">// update to action</span>\n&lt;form action={addToCart}&gt;[‚Ä¶]&lt;/form&gt;;\n</code></pre><p>Same as above. But here&#39;s what cool if you&#39;re using something like Next.js or Remix: we can use the <code>&#39;use server&#39;</code> directive here and make this a <em>server</em> action. Something like</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">addToCart</span>(<span class=\"hljs-params\">formData</span>) {\n  <span class=\"hljs-string\">&quot;use server&quot;</span>;\n  <span class=\"hljs-title function_\">sql</span>(<span class=\"hljs-string\">`INSERT INTO cart (user_id, pizza_type, size) VALUES ($1, $2)`</span>, [\n    formData.<span class=\"hljs-property\">pizza_type</span>,\n    formData.<span class=\"hljs-property\">size</span>,\n  ]);\n}\n</code></pre><p>Since it&#39;s on the server, we can now safely insert into our database, directly from inside our React component. React/Next.js will handle all the details of handling the execution of that on server. Pretty cool, right? We&#39;ll talk more about this in Intermediate React v6.</p>\n<p>Let&#39;s do one more cool trick here. There&#39;s a new hook called <code>useFormStatus</code> that lets children components see if they&#39;re inside of a form being submitted without having to pass lots of data around.</p>\n<p>In <code>contact.lazy.jsx</code></p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">// at top</span>\n<span class=\"hljs-keyword\">import</span> { useFormStatus } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;react-dom&quot;</span>; <span class=\"hljs-comment\">// note react-dom, not react</span>\n\n<span class=\"hljs-comment\">// replace the two inputs</span>\n<span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ContactInput</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;name&quot;</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text&quot;</span> <span class=\"hljs-attr\">placeholder</span>=<span class=\"hljs-string\">&quot;Name&quot;</span> /&gt;</span></span>\n<span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ContactInput</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;email&quot;</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;email&quot;</span> <span class=\"hljs-attr\">placeholder</span>=<span class=\"hljs-string\">&quot;Email&quot;</span> /&gt;</span></span>\n\n<span class=\"hljs-comment\">// at the bottom</span>\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">ContactInput</span>(<span class=\"hljs-params\">props</span>) {\n  <span class=\"hljs-keyword\">const</span> { pending } = <span class=\"hljs-title function_\">useFormStatus</span>();\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span>\n      <span class=\"hljs-attr\">disabled</span>=<span class=\"hljs-string\">{pending}</span>\n      <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">{props.name}</span>\n      <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">{props.type}</span>\n      <span class=\"hljs-attr\">placeholder</span>=<span class=\"hljs-string\">{props.placeholder}</span>\n    /&gt;</span></span>\n  );\n}\n</code></pre><ul>\n<li>This is a silly example, but imagine you had really complicated inputs that had a design system, tool tips, and all sorts of other UIs. This is common in large React codebases. This could be really useful for that.</li>\n<li>As a side note, if I have really small components like ContactInput, I&#39;ll just stick in the same file like we did here. It can be a useful pattern. Some people are purists and demand one file, one component. I am not a purist.</li>\n<li>We didn&#39;t do the button or the text area just for brevity&#39;s sake but you could.</li>\n<li>Since we&#39;re local, this pending state will be super short. But you will notice the background flash gray. That&#39;s the disabled state.</li>\n</ul>\n<p>And that&#39;s form actions!</p>\n<blockquote>\n<p>üèÅ <a href=\"https://github.com/btholt/citr-v9-project/tree/master/15-form-actions\">Click here to see the state of the project up until now: 15-form-actions</a></p>\n</blockquote>\n","markdown":"\n## Form Actions\n\nOkay, so let's actually upgrade our app to be React 19.\n\n> üö® Pay attention here, as you need to figure out which version of React to install.\n\n[Go here][npm] and look at the versions of React published on npm. If you see that React 19 is still in canary/rc/next (which are all the same) then you can run `npm i react@rc react-dom@rc`. You'll get a lot of warnings about things not matching versions in your command-line, that's totally okay.\n\nIf React 19 is latest, then run `npm install react@19 react-dom@19` and then follow these instructions. Be extra cautious because things may have changed!!\n\nOkay, let's talk form actions. A lot of web interfaces is just handling form inputs, and so the React team decided to make it easier to do that. It's actually really similar to what we've done already, just a little less boilerplate. Open your contact.lazy.jsx and let's modify this page to use a form action.\n\n```javascript\nmutationFn: function (formData) { // change to formData\n  // remove e.preventDefault\n  // remove formData constructor\n  return postContact(\n    formData.get(\"name\"),\n    formData.get(\"email\"),\n    formData.get(\"message\"),\n  );\n},\n\n// change onSubmit to action\n<form action={mutation.mutate}>\n```\n\nThat's it! It really is just a convenience function to make handling for submits even easier to do. There's nothing wrong with what we had either, and that will continue to work as-is too.\n\nLet's go convert `order.lazy.jsx` too\n\n```javascript\n// extract submission function from form\nfunction addToCart() {\n  setCart([...cart, { pizza: selectedPizza, size: pizzaSize, price }]);\n}\n// update to action\n<form action={addToCart}>[‚Ä¶]</form>;\n```\n\nSame as above. But here's what cool if you're using something like Next.js or Remix: we can use the `'use server'` directive here and make this a _server_ action. Something like\n\n```javascript\nfunction addToCart(formData) {\n  \"use server\";\n  sql(`INSERT INTO cart (user_id, pizza_type, size) VALUES ($1, $2)`, [\n    formData.pizza_type,\n    formData.size,\n  ]);\n}\n```\n\nSince it's on the server, we can now safely insert into our database, directly from inside our React component. React/Next.js will handle all the details of handling the execution of that on server. Pretty cool, right? We'll talk more about this in Intermediate React v6.\n\nLet's do one more cool trick here. There's a new hook called `useFormStatus` that lets children components see if they're inside of a form being submitted without having to pass lots of data around.\n\nIn `contact.lazy.jsx`\n\n```javascript\n// at top\nimport { useFormStatus } from \"react-dom\"; // note react-dom, not react\n\n// replace the two inputs\n<ContactInput name=\"name\" type=\"text\" placeholder=\"Name\" />\n<ContactInput name=\"email\" type=\"email\" placeholder=\"Email\" />\n\n// at the bottom\nfunction ContactInput(props) {\n  const { pending } = useFormStatus();\n  return (\n    <input\n      disabled={pending}\n      name={props.name}\n      type={props.type}\n      placeholder={props.placeholder}\n    />\n  );\n}\n```\n\n- This is a silly example, but imagine you had really complicated inputs that had a design system, tool tips, and all sorts of other UIs. This is common in large React codebases. This could be really useful for that.\n- As a side note, if I have really small components like ContactInput, I'll just stick in the same file like we did here. It can be a useful pattern. Some people are purists and demand one file, one component. I am not a purist.\n- We didn't do the button or the text area just for brevity's sake but you could.\n- Since we're local, this pending state will be super short. But you will notice the background flash gray. That's the disabled state.\n\nAnd that's form actions!\n\n> üèÅ [Click here to see the state of the project up until now: 15-form-actions][step]\n\n[step]: https://github.com/btholt/citr-v9-project/tree/master/15-form-actions\n[npm]: https://www.npmjs.com/package/react?activeTab=versions","slug":"form-actions","title":"Form Actions","section":"Whats Next","icon":"shuttle-space","filePath":"/home/runner/work/complete-intro-to-react-v9/complete-intro-to-react-v9/lessons/08-whats-next/B-form-actions.md","nextSlug":"/lessons/whats-next/use-and-suspense","prevSlug":"/lessons/whats-next/react-19"}},"__N_SSG":true}