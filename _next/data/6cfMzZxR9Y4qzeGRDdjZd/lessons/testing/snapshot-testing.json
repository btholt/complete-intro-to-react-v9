{"pageProps":{"post":{"attributes":{"description":"Discover snapshot testing in React with Brian Holt's Complete Intro to React, a course offering insights into efficient testing techniques for components like Cart.jsx. Learn about the benefits and limitations of snapshot tests, how to implement them using tools like Vitest, and explore their practical applications in UI and API development. Ideal for developers looking to enhance their testing strategies in web development.","keywords":["React","Snapshot Testing","Brian Holt","Vitest","UI Testing"]},"html":"<p>I&#39;m not a fan of seeking 100% test coverage. I think it&#39;s a fool&#39;s errand and a waste of time. I&#39;d rather you write five tests that cover the most important five lines of your code than see you write one test for five less-important pieces of UI code.</p>\n<p>But let&#39;s show you an easy way to cheat and get there! Let&#39;s talk about snapshot testing.</p>\n<p>Snapshot tests are low confidence, low cost ways of writing tests. With more-or-less a single line of code you can assert: this code doesn&#39;t break, and it isn&#39;t changing over time.</p>\n<p>Let&#39;s test Cart.jsx. It&#39;s a pretty stable component that doesn&#39;t do a lot and we don&#39;t expect it to change a lot if at all. A low cost, low confidence test could fit here. Make a file called Cart.test.jsx</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { expect, test } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { render } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@testing-library/react&quot;</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Cart</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../Cart&quot;</span>;\n\n<span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;snapshot with nothing in cart&quot;</span>, <span class=\"hljs-function\">() =&gt;</span> {\n  <span class=\"hljs-keyword\">const</span> { asFragment } = <span class=\"hljs-title function_\">render</span>(<span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Cart</span> <span class=\"hljs-attr\">cart</span>=<span class=\"hljs-string\">{[]}</span> /&gt;</span></span>);\n  <span class=\"hljs-title function_\">expect</span>(<span class=\"hljs-title function_\">asFragment</span>()).<span class=\"hljs-title function_\">toMatchSnapshot</span>();\n});\n</code></pre><p>Run this to see Vitest say it created a snapshot. Go look now at Cart.test.jsx.snap in the <code>src/__tests__/__snapshots__</code> to see what it created. You can see it&#39;s just rendering out what it would look like. Now if you modify Cart.jsx it will fail the test. As you can see, it&#39;s a quick gut check to make sure your changes don&#39;t have cascading problems. If I modify App.jsx and it causes this to fail it means I can catch it and validate quickly. Some people don&#39;t find it useful. I&#39;m not entirely sold on it to be honest; at most these should be used very sparingly. This could be useful if you have a component that you expect to <em>never</em> change and it would be a problem if it did. Maybe a footer? I don&#39;t know. I never write these.</p>\n<p>Let&#39;s add some pizzas and see how it does.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;snapshot with some stuff in cart&quot;</span>, <span class=\"hljs-function\">() =&gt;</span> {\n  <span class=\"hljs-keyword\">const</span> { asFragment } = <span class=\"hljs-title function_\">render</span>(\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Cart</span>\n      <span class=\"hljs-attr\">cart</span>=<span class=\"hljs-string\">{[</span>\n        {\n          <span class=\"hljs-attr\">pizza:</span> {\n            <span class=\"hljs-attr\">id:</span> &quot;<span class=\"hljs-attr\">pepperoni</span>&quot;,\n            <span class=\"hljs-attr\">name:</span> &quot;<span class=\"hljs-attr\">The</span> <span class=\"hljs-attr\">Pepperoni</span> <span class=\"hljs-attr\">Pizza</span>&quot;,\n            <span class=\"hljs-attr\">category:</span> &quot;<span class=\"hljs-attr\">Classic</span>&quot;,\n            <span class=\"hljs-attr\">description:</span> &quot;<span class=\"hljs-attr\">Mozzarella</span> <span class=\"hljs-attr\">Cheese</span>, <span class=\"hljs-attr\">Pepperoni</span>&quot;,\n            <span class=\"hljs-attr\">image:</span> &quot;/<span class=\"hljs-attr\">public</span>/<span class=\"hljs-attr\">pizzas</span>/<span class=\"hljs-attr\">pepperoni.webp</span>&quot;,\n            <span class=\"hljs-attr\">sizes:</span> {\n              <span class=\"hljs-attr\">S:</span> <span class=\"hljs-attr\">9.75</span>,\n              <span class=\"hljs-attr\">M:</span> <span class=\"hljs-attr\">12.5</span>,\n              <span class=\"hljs-attr\">L:</span> <span class=\"hljs-attr\">15.25</span>,\n            },\n          },\n          <span class=\"hljs-attr\">size:</span> &quot;<span class=\"hljs-attr\">M</span>&quot;,\n          <span class=\"hljs-attr\">price:</span> &quot;$<span class=\"hljs-attr\">12.50</span>&quot;,\n        },\n        {\n          <span class=\"hljs-attr\">pizza:</span> {\n            <span class=\"hljs-attr\">id:</span> &quot;<span class=\"hljs-attr\">ckn_pesto</span>&quot;,\n            <span class=\"hljs-attr\">name:</span> &quot;<span class=\"hljs-attr\">The</span> <span class=\"hljs-attr\">Chicken</span> <span class=\"hljs-attr\">Pesto</span> <span class=\"hljs-attr\">Pizza</span>&quot;,\n            <span class=\"hljs-attr\">category:</span> &quot;<span class=\"hljs-attr\">Chicken</span>&quot;,\n            <span class=\"hljs-attr\">description:</span>\n              &quot;<span class=\"hljs-attr\">Chicken</span>, <span class=\"hljs-attr\">Tomatoes</span>, <span class=\"hljs-attr\">Red</span> <span class=\"hljs-attr\">Peppers</span>, <span class=\"hljs-attr\">Spinach</span>, <span class=\"hljs-attr\">Garlic</span>, <span class=\"hljs-attr\">Pesto</span> <span class=\"hljs-attr\">Sauce</span>&quot;,\n            <span class=\"hljs-attr\">image:</span> &quot;/<span class=\"hljs-attr\">public</span>/<span class=\"hljs-attr\">pizzas</span>/<span class=\"hljs-attr\">ckn_pesto.webp</span>&quot;,\n            <span class=\"hljs-attr\">sizes:</span> {\n              <span class=\"hljs-attr\">S:</span> <span class=\"hljs-attr\">12.75</span>,\n              <span class=\"hljs-attr\">M:</span> <span class=\"hljs-attr\">16.75</span>,\n              <span class=\"hljs-attr\">L:</span> <span class=\"hljs-attr\">20.75</span>,\n            },\n          },\n          <span class=\"hljs-attr\">size:</span> &quot;<span class=\"hljs-attr\">L</span>&quot;,\n          <span class=\"hljs-attr\">price:</span> &quot;$<span class=\"hljs-attr\">20.75</span>&quot;,\n        },\n        {\n          <span class=\"hljs-attr\">pizza:</span> {\n            <span class=\"hljs-attr\">id:</span> &quot;<span class=\"hljs-attr\">bbq_ckn</span>&quot;,\n            <span class=\"hljs-attr\">name:</span> &quot;<span class=\"hljs-attr\">The</span> <span class=\"hljs-attr\">Barbecue</span> <span class=\"hljs-attr\">Chicken</span> <span class=\"hljs-attr\">Pizza</span>&quot;,\n            <span class=\"hljs-attr\">category:</span> &quot;<span class=\"hljs-attr\">Chicken</span>&quot;,\n            <span class=\"hljs-attr\">description:</span>\n              &quot;<span class=\"hljs-attr\">Barbecued</span> <span class=\"hljs-attr\">Chicken</span>, <span class=\"hljs-attr\">Red</span> <span class=\"hljs-attr\">Peppers</span>, <span class=\"hljs-attr\">Green</span> <span class=\"hljs-attr\">Peppers</span>, <span class=\"hljs-attr\">Tomatoes</span>, <span class=\"hljs-attr\">Red</span> <span class=\"hljs-attr\">Onions</span>, <span class=\"hljs-attr\">Barbecue</span> <span class=\"hljs-attr\">Sauce</span>&quot;,\n            <span class=\"hljs-attr\">image:</span> &quot;/<span class=\"hljs-attr\">public</span>/<span class=\"hljs-attr\">pizzas</span>/<span class=\"hljs-attr\">bbq_ckn.webp</span>&quot;,\n            <span class=\"hljs-attr\">sizes:</span> {\n              <span class=\"hljs-attr\">S:</span> <span class=\"hljs-attr\">12.75</span>,\n              <span class=\"hljs-attr\">M:</span> <span class=\"hljs-attr\">16.75</span>,\n              <span class=\"hljs-attr\">L:</span> <span class=\"hljs-attr\">20.75</span>,\n            },\n          },\n          <span class=\"hljs-attr\">size:</span> &quot;<span class=\"hljs-attr\">S</span>&quot;,\n          <span class=\"hljs-attr\">price:</span> &quot;$<span class=\"hljs-attr\">12.75</span>&quot;,\n        },\n      ]}\n    /&gt;</span></span>\n  );\n  <span class=\"hljs-title function_\">expect</span>(<span class=\"hljs-title function_\">asFragment</span>()).<span class=\"hljs-title function_\">toMatchSnapshot</span>();\n});\n</code></pre><p>This works, and now you can stick with this, but here&#39;s a problem. If you look at your snapshot, it&#39;s rendering Pizza components as well. Now if you modify Pizza.jsx (that has its own tests already) your <em>Cart.jsx</em> test is going to fail. This is misleading, nothing is wrong or different with Cart.jsx. In a previous version of this class I show you how to accomplish this with react-test-renderer. However the folks at @testing-lib think shallow rendering is more harmful than helpful (I like, 75% agree) so we&#39;ll leave it out. <a href=\"https://frontendmasters.com/courses/intermediate-react-v4/snapshots/\">Click here</a> to see me teach this previously. It&#39;s 95% the same, just uses Jest instead of Vitest.</p>\n<p>Update your snapshots by either running <code>npm run test -- -u</code> or you can use the watcher to do it with either <code>u</code> to update all at once or do <code>i</code> one-by-one.</p>\n<p>You should commit snapshot files to git.</p>\n<p>I&#39;ll leave it up to you how much you value these tests. I think they have a very limited place in UI testing but it&#39;s pretty low level of help. Frequently they become more noise than help. In any case, keep them in your toolbox, some times they can be helpful.</p>\n<blockquote>\n<p>As a side note, one place I saw some use for snapshot tests (as they can track any object shape over time, not just React components) was in the backend in API response shapes. We&#39;d write a snapshot test that this API response is always going to look like this and it should fail the test if it breaks. This makes it very intentional every time you modify the API response (since your API clients are likely relying on it being a certain shape.) Furthermore, it means the frontend devs can use these snapshot files to see what the API response is going to look like. Niche, but it was helpful on the one project I worked on that had it.</p>\n</blockquote>\n","markdown":"\nI'm not a fan of seeking 100% test coverage. I think it's a fool's errand and a waste of time. I'd rather you write five tests that cover the most important five lines of your code than see you write one test for five less-important pieces of UI code.\n\nBut let's show you an easy way to cheat and get there! Let's talk about snapshot testing.\n\nSnapshot tests are low confidence, low cost ways of writing tests. With more-or-less a single line of code you can assert: this code doesn't break, and it isn't changing over time.\n\nLet's test Cart.jsx. It's a pretty stable component that doesn't do a lot and we don't expect it to change a lot if at all. A low cost, low confidence test could fit here. Make a file called Cart.test.jsx\n\n```javascript\nimport { expect, test } from \"vitest\";\nimport { render } from \"@testing-library/react\";\nimport Cart from \"../Cart\";\n\ntest(\"snapshot with nothing in cart\", () => {\n  const { asFragment } = render(<Cart cart={[]} />);\n  expect(asFragment()).toMatchSnapshot();\n});\n```\n\nRun this to see Vitest say it created a snapshot. Go look now at Cart.test.jsx.snap in the `src/__tests__/__snapshots__` to see what it created. You can see it's just rendering out what it would look like. Now if you modify Cart.jsx it will fail the test. As you can see, it's a quick gut check to make sure your changes don't have cascading problems. If I modify App.jsx and it causes this to fail it means I can catch it and validate quickly. Some people don't find it useful. I'm not entirely sold on it to be honest; at most these should be used very sparingly. This could be useful if you have a component that you expect to _never_ change and it would be a problem if it did. Maybe a footer? I don't know. I never write these.\n\nLet's add some pizzas and see how it does.\n\n```javascript\ntest(\"snapshot with some stuff in cart\", () => {\n  const { asFragment } = render(\n    <Cart\n      cart={[\n        {\n          pizza: {\n            id: \"pepperoni\",\n            name: \"The Pepperoni Pizza\",\n            category: \"Classic\",\n            description: \"Mozzarella Cheese, Pepperoni\",\n            image: \"/public/pizzas/pepperoni.webp\",\n            sizes: {\n              S: 9.75,\n              M: 12.5,\n              L: 15.25,\n            },\n          },\n          size: \"M\",\n          price: \"$12.50\",\n        },\n        {\n          pizza: {\n            id: \"ckn_pesto\",\n            name: \"The Chicken Pesto Pizza\",\n            category: \"Chicken\",\n            description:\n              \"Chicken, Tomatoes, Red Peppers, Spinach, Garlic, Pesto Sauce\",\n            image: \"/public/pizzas/ckn_pesto.webp\",\n            sizes: {\n              S: 12.75,\n              M: 16.75,\n              L: 20.75,\n            },\n          },\n          size: \"L\",\n          price: \"$20.75\",\n        },\n        {\n          pizza: {\n            id: \"bbq_ckn\",\n            name: \"The Barbecue Chicken Pizza\",\n            category: \"Chicken\",\n            description:\n              \"Barbecued Chicken, Red Peppers, Green Peppers, Tomatoes, Red Onions, Barbecue Sauce\",\n            image: \"/public/pizzas/bbq_ckn.webp\",\n            sizes: {\n              S: 12.75,\n              M: 16.75,\n              L: 20.75,\n            },\n          },\n          size: \"S\",\n          price: \"$12.75\",\n        },\n      ]}\n    />\n  );\n  expect(asFragment()).toMatchSnapshot();\n});\n```\n\nThis works, and now you can stick with this, but here's a problem. If you look at your snapshot, it's rendering Pizza components as well. Now if you modify Pizza.jsx (that has its own tests already) your _Cart.jsx_ test is going to fail. This is misleading, nothing is wrong or different with Cart.jsx. In a previous version of this class I show you how to accomplish this with react-test-renderer. However the folks at @testing-lib think shallow rendering is more harmful than helpful (I like, 75% agree) so we'll leave it out. [Click here][fem] to see me teach this previously. It's 95% the same, just uses Jest instead of Vitest.\n\nUpdate your snapshots by either running `npm run test -- -u` or you can use the watcher to do it with either `u` to update all at once or do `i` one-by-one.\n\nYou should commit snapshot files to git.\n\nI'll leave it up to you how much you value these tests. I think they have a very limited place in UI testing but it's pretty low level of help. Frequently they become more noise than help. In any case, keep them in your toolbox, some times they can be helpful.\n\n> As a side note, one place I saw some use for snapshot tests (as they can track any object shape over time, not just React components) was in the backend in API response shapes. We'd write a snapshot test that this API response is always going to look like this and it should fail the test if it breaks. This makes it very intentional every time you modify the API response (since your API clients are likely relying on it being a certain shape.) Furthermore, it means the frontend devs can use these snapshot files to see what the API response is going to look like. Niche, but it was helpful on the one project I worked on that had it.\n\n[fem]: https://frontendmasters.com/courses/intermediate-react-v4/snapshots/\n","slug":"snapshot-testing","title":"Snapshot Testing","section":"Testing","icon":"vial","filePath":"/home/runner/work/complete-intro-to-react-v9/complete-intro-to-react-v9/lessons/07-testing/E-snapshot-testing.md","nextSlug":"/lessons/testing/coverage","prevSlug":"/lessons/testing/testing-custom-hooks"}},"__N_SSG":true}