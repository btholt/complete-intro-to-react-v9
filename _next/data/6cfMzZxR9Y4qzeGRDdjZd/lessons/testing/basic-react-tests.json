{"pageProps":{"post":{"attributes":{"description":"Learn how to effectively test React components with a focus on functionality over implementation using React Testing Library, through this hands-on guide by Brian Holt. Gain insights into user-centric testing methodologies, writing bug-catching tests, and managing test lifecycle for enhanced app reliability, specifically applied to the Pizza.jsx component.","keywords":["React Testing","React","Vitest","Testing Library","React Components","Brian Holt","Pizza.jsx"]},"html":"<p>Let&#39;s write our first test for Pizza.jsx. In general, here&#39;s my methodology for testing React:</p>\n<ul>\n<li>Try to test functionality, not implementation. Make your tests interact with components as a user would, not as a developer would. This means you&#39;re trying to do more to think of things like &quot;what would a user see&quot; or &quot;if a user clicks a button a modal comes up&quot; rather than &quot;make sure this state is correct&quot; or &quot;ensure this library is called&quot;. This isn&#39;t a rule; sometimes you need to test those things too for assurance the app is working correctly. Use your best judgment.</li>\n<li>Every UI I&#39;ve ever worked on changes a lot. Try to not unnecessarily spin your wheels on things that aren&#39;t important and are likely to change.</li>\n<li>In general when I encounter a bug that is important for me to go back and fix, I&#39;ll write a test that would have caught that bug. Actually what I&#39;ll do is <em>before</em> I fix it, I&#39;ll write the test that fails. That way I fix it I&#39;ll know I won&#39;t regress back there.</li>\n<li>Ask yourself what&#39;s important about your app and spend your time testing that. Ask yourself &quot;if a user couldn&#39;t do X then the app is worthless&quot; sort of questions and test those more thoroughly. If a user can&#39;t change themes then it&#39;s probably not the end of the world (a11y is important) so you can spend less time testing that but if a user can&#39;t log in then the app is worthless. Test that.</li>\n<li>Delete tests on a regular basis. Tests have a shelf life.</li>\n<li>Fix or delete flaky tests. Bad tests are worse than no tests.</li>\n</ul>\n<p>Okay, create a new file called <code>Pizza.test.jsx</code>. This naming convention is just habit. <code>Pizza.spec.jsx</code> is common too. But as long as it&#39;s in the <code>__tests__</code> directory it doesn&#39;t much matter what you call it.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { render } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@testing-library/react&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { expect, test } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest&quot;</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Pizza</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../Pizza&quot;</span>;\n\n<span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;alt text renders on image&quot;</span>, <span class=\"hljs-title function_\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> name = <span class=\"hljs-string\">&quot;My Favorite Pizza&quot;</span>;\n  <span class=\"hljs-keyword\">const</span> src = <span class=\"hljs-string\">&quot;https://picsum.photos/200&quot;</span>;\n  <span class=\"hljs-keyword\">const</span> screen = <span class=\"hljs-title function_\">render</span>(\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Pizza</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">{name}</span> <span class=\"hljs-attr\">description</span>=<span class=\"hljs-string\">&quot;super cool pizza&quot;</span> <span class=\"hljs-attr\">image</span>=<span class=\"hljs-string\">{src}</span> /&gt;</span></span>\n  );\n\n  <span class=\"hljs-keyword\">const</span> img = screen.<span class=\"hljs-title function_\">getByRole</span>(<span class=\"hljs-string\">&quot;img&quot;</span>);\n  <span class=\"hljs-title function_\">expect</span>(img.<span class=\"hljs-property\">src</span>).<span class=\"hljs-title function_\">toBe</span>(src);\n  <span class=\"hljs-title function_\">expect</span>(img.<span class=\"hljs-property\">alt</span>).<span class=\"hljs-title function_\">toBe</span>(name);\n});\n</code></pre><p>This is your most basic test. It renders a React component, and then starts running assertions on it. Here we&#39;re asserting that our pizza image ends up with the correct alt text on it. Not the most useful test but a good start for us seeing how to assert something. I could see this being useful if we had bugs that occasionally alt text wasn&#39;t showing up.</p>\n<p>We&#39;re using getByRole here to grab the image on the page. In general React Testing Library wants you to adopt a user-centric mindset of how you&#39;re asserting things on the page. In this case we&#39;re trying to find an image which is something a user would see. Contrast that with using a CSS selector to select the image (which you can do, it&#39;s just frowned upon) which is very implementation-centric (a user doesn&#39;t know nor care about CSS classes.)</p>\n<p>Let&#39;s add another test to make sure that we have a default image if pizza isn&#39;t passed an image.</p>\n<blockquote>\n<p>ðŸš¨ This doesn&#39;t work yet. That&#39;s intentional.</p>\n</blockquote>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;to have default image if none is provided&quot;</span>, <span class=\"hljs-title function_\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> screen = <span class=\"hljs-title function_\">render</span>(\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Pizza</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">{</span>&quot;<span class=\"hljs-attr\">Cool</span> <span class=\"hljs-attr\">Pizza</span>&quot;} <span class=\"hljs-attr\">description</span>=<span class=\"hljs-string\">&quot;super cool pizza&quot;</span> /&gt;</span></span>\n  );\n\n  <span class=\"hljs-keyword\">const</span> img = screen.<span class=\"hljs-title function_\">getByRole</span>(<span class=\"hljs-string\">&quot;img&quot;</span>);\n  <span class=\"hljs-title function_\">expect</span>(img.<span class=\"hljs-property\">src</span>).<span class=\"hljs-property\">not</span>.<span class=\"hljs-title function_\">toBe</span>(<span class=\"hljs-string\">&quot;&quot;</span>);\n});\n</code></pre><p>Well, first thing it is going to complain about is that we don&#39;t clean up after ourselves after each test. React Testing Library requires us to.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">// at top</span>\n<span class=\"hljs-keyword\">import</span> { render, cleanup } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@testing-library/react&quot;</span>; <span class=\"hljs-comment\">// add cleanup</span>\n<span class=\"hljs-keyword\">import</span> { afterEach, expect, test } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest&quot;</span>; <span class=\"hljs-comment\">// add afterEach</span>\n<span class=\"hljs-title function_\">afterEach</span>(cleanup);\n</code></pre><p>The test still doesn&#39;t pass? Oh, that&#39;s because it caught a bug! If you don&#39;t give it a image, it just breaks. That&#39;s not a good user experience. Let&#39;s go fix it in Pizza.jsx.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">// replace src</span>\nsrc={props.<span class=\"hljs-property\">image</span> ? props.<span class=\"hljs-property\">image</span> : <span class=\"hljs-string\">&quot;https://picsum.photos/200&quot;</span>}\n</code></pre><p>Now it works!</p>\n<p>Bam! Some easy React testing there for you.</p>\n","markdown":"\nLet's write our first test for Pizza.jsx. In general, here's my methodology for testing React:\n\n- Try to test functionality, not implementation. Make your tests interact with components as a user would, not as a developer would. This means you're trying to do more to think of things like \"what would a user see\" or \"if a user clicks a button a modal comes up\" rather than \"make sure this state is correct\" or \"ensure this library is called\". This isn't a rule; sometimes you need to test those things too for assurance the app is working correctly. Use your best judgment.\n- Every UI I've ever worked on changes a lot. Try to not unnecessarily spin your wheels on things that aren't important and are likely to change.\n- In general when I encounter a bug that is important for me to go back and fix, I'll write a test that would have caught that bug. Actually what I'll do is _before_ I fix it, I'll write the test that fails. That way I fix it I'll know I won't regress back there.\n- Ask yourself what's important about your app and spend your time testing that. Ask yourself \"if a user couldn't do X then the app is worthless\" sort of questions and test those more thoroughly. If a user can't change themes then it's probably not the end of the world (a11y is important) so you can spend less time testing that but if a user can't log in then the app is worthless. Test that.\n- Delete tests on a regular basis. Tests have a shelf life.\n- Fix or delete flaky tests. Bad tests are worse than no tests.\n\nOkay, create a new file called `Pizza.test.jsx`. This naming convention is just habit. `Pizza.spec.jsx` is common too. But as long as it's in the `__tests__` directory it doesn't much matter what you call it.\n\n```javascript\nimport { render } from \"@testing-library/react\";\nimport { expect, test } from \"vitest\";\nimport Pizza from \"../Pizza\";\n\ntest(\"alt text renders on image\", async () => {\n  const name = \"My Favorite Pizza\";\n  const src = \"https://picsum.photos/200\";\n  const screen = render(\n    <Pizza name={name} description=\"super cool pizza\" image={src} />\n  );\n\n  const img = screen.getByRole(\"img\");\n  expect(img.src).toBe(src);\n  expect(img.alt).toBe(name);\n});\n```\n\nThis is your most basic test. It renders a React component, and then starts running assertions on it. Here we're asserting that our pizza image ends up with the correct alt text on it. Not the most useful test but a good start for us seeing how to assert something. I could see this being useful if we had bugs that occasionally alt text wasn't showing up.\n\nWe're using getByRole here to grab the image on the page. In general React Testing Library wants you to adopt a user-centric mindset of how you're asserting things on the page. In this case we're trying to find an image which is something a user would see. Contrast that with using a CSS selector to select the image (which you can do, it's just frowned upon) which is very implementation-centric (a user doesn't know nor care about CSS classes.)\n\nLet's add another test to make sure that we have a default image if pizza isn't passed an image.\n\n> ðŸš¨ This doesn't work yet. That's intentional.\n\n```javascript\ntest(\"to have default image if none is provided\", async () => {\n  const screen = render(\n    <Pizza name={\"Cool Pizza\"} description=\"super cool pizza\" />\n  );\n\n  const img = screen.getByRole(\"img\");\n  expect(img.src).not.toBe(\"\");\n});\n```\n\nWell, first thing it is going to complain about is that we don't clean up after ourselves after each test. React Testing Library requires us to.\n\n```javascript\n// at top\nimport { render, cleanup } from \"@testing-library/react\"; // add cleanup\nimport { afterEach, expect, test } from \"vitest\"; // add afterEach\nafterEach(cleanup);\n```\n\nThe test still doesn't pass? Oh, that's because it caught a bug! If you don't give it a image, it just breaks. That's not a good user experience. Let's go fix it in Pizza.jsx.\n\n```javascript\n// replace src\nsrc={props.image ? props.image : \"https://picsum.photos/200\"}\n```\n\nNow it works!\n\nBam! Some easy React testing there for you.\n","slug":"basic-react-tests","title":"Basic React Tests","section":"Testing","icon":"vial","filePath":"/home/runner/work/complete-intro-to-react-v9/complete-intro-to-react-v9/lessons/07-testing/B-basic-react-tests.md","nextSlug":"/lessons/testing/testing-user-interaction","prevSlug":"/lessons/testing/vitest"}},"__N_SSG":true}