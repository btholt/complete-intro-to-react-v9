{"pageProps":{"post":{"attributes":{"description":"Explore the emerging support for browser-based testing with Vitest, featuring Playwright integration for fast and reliable testing. Learn how to configure Vitest for both Node.js and browser environments, leveraging libraries like vitest-browser-react, and gain insights from Brian Holt on crafting effective tests for user experiences in React applications. This guide is ideal for developers keen on improving their testing setups in modern web development environments.","keywords":["Vitest","Playwright","browser-based testing","React testing","vitest-browser-react","Brian Holt","web development"]},"html":"<blockquote>\n<p>üö® This is experimental and very likely to change in the future. Consider this a sneak peak into what is coming, not what to do today.</p>\n</blockquote>\n<p>Vitest is beginning to support more deeply browser-based testing. To those of us that have been around long enough to remember Selenium, this may strike fear deep int your heart. But fear not! Browser-based testing tools have come so far along since then that it&#39;s both fast and reliable, in particular thanks to the Microsoft project <a href=\"https://playwright.dev/\">Playwright</a>.</p>\n<p>However this is still early days. I&#39;m going to show you how to set it up but be warned that this prone to change as they&#39;re still actively working on it!</p>\n<p>So first let&#39;s install the libraries we need.</p>\n<pre><code class=\"hljs language-bash\">npm i -D @vitest/browser@2.1.3 playwright@1.48.0 vitest-browser-react@0.0.1\n</code></pre><p>You can see that the vitest-browser-react library is still 0.0.1 as of writing so be extra aware it&#39;s likely to have changed by the time you read this.</p>\n<p>Okay, so now we want to write browser based tests. But we have also have a bunch of existing Node.js-based tests. Some our already-existing Node.js based tests won&#39;t work in the browser. But no worries, Vitest/Vite has a tool just for this, workspaces. It&#39;s actually made to handle monorepos, but it will work here just as well. Make a file called <code>vitest.workspace.js</code> (you don&#39;t normally need this as your Vite config is normally enough.)</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { defineWorkspace } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest/config&quot;</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-title function_\">defineWorkspace</span>([\n  {\n    <span class=\"hljs-attr\">extends</span>: <span class=\"hljs-string\">&quot;./vite.config.js&quot;</span>,\n    <span class=\"hljs-attr\">test</span>: {\n      <span class=\"hljs-attr\">include</span>: [<span class=\"hljs-string\">&quot;**/*.node.test.{js,jsx}&quot;</span>],\n      <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&quot;happy-dom&quot;</span>,\n      <span class=\"hljs-attr\">environment</span>: <span class=\"hljs-string\">&quot;happy-dom&quot;</span>,\n    },\n  },\n  {\n    <span class=\"hljs-attr\">extends</span>: <span class=\"hljs-string\">&quot;./vite.config.js&quot;</span>,\n    <span class=\"hljs-attr\">test</span>: {\n      <span class=\"hljs-attr\">setupFiles</span>: [<span class=\"hljs-string\">&quot;vitest-browser-react&quot;</span>],\n      <span class=\"hljs-attr\">include</span>: [<span class=\"hljs-string\">&quot;**/*.browser.test.{js,jsx}&quot;</span>],\n      <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&quot;browser&quot;</span>,\n      <span class=\"hljs-attr\">browser</span>: {\n        <span class=\"hljs-attr\">provider</span>: <span class=\"hljs-string\">&quot;playwright&quot;</span>,\n        <span class=\"hljs-attr\">enabled</span>: <span class=\"hljs-literal\">true</span>,\n        <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&quot;firefox&quot;</span>, <span class=\"hljs-comment\">// you can use chromium or webkit here too</span>\n      },\n    },\n  },\n]);\n</code></pre><p>Now delete the <code>test</code> items from your vite.config.js file.</p>\n<p>This is a test-only config for Vite (and therefore Vitest.) Now if a test ends in <code>.node.test.jsx</code> it will run through the happy-dom based environment and if it ends in <code>.browser.test.jsx</code> it will run in our new browser-based environment with Playwright. Let&#39;s go rename our tests to reflect that.</p>\n<ul>\n<li>Cart.browser.test.jsx</li>\n<li>contact.lazy.node.test.jsx</li>\n<li>Pizza.node.test.jsx</li>\n<li>usePizzaOfTheDay.node.test.jsx</li>\n</ul>\n<p>Snapshotting works in the browser so that one works okay. Anything using vitest-fetch-mock is Node.js only so for those we need to mark them as node. We&#39;re going to make a new Pizza file so let&#39;s leave that one. And our custom hook test mocks fetch so that one is Node only.</p>\n<p>Okay, now create a <code>Pizza.browser.test.jsx</code></p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { render } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest-browser-react&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { expect, test } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest&quot;</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Pizza</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../Pizza&quot;</span>;\n\n<span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;alt text renders on image&quot;</span>, <span class=\"hljs-title function_\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> name = <span class=\"hljs-string\">&quot;My Favorite Pizza&quot;</span>;\n  <span class=\"hljs-keyword\">const</span> src = <span class=\"hljs-string\">&quot;https://picsum.photos/200&quot;</span>;\n  <span class=\"hljs-keyword\">const</span> screen = <span class=\"hljs-title function_\">render</span>(\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Pizza</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">{name}</span> <span class=\"hljs-attr\">description</span>=<span class=\"hljs-string\">&quot;super cool pizza&quot;</span> <span class=\"hljs-attr\">image</span>=<span class=\"hljs-string\">{src}</span> /&gt;</span></span>\n  );\n\n  <span class=\"hljs-keyword\">const</span> img = <span class=\"hljs-keyword\">await</span> screen.<span class=\"hljs-title function_\">getByRole</span>(<span class=\"hljs-string\">&quot;img&quot;</span>);\n\n  <span class=\"hljs-keyword\">await</span> expect.<span class=\"hljs-title function_\">element</span>(img).<span class=\"hljs-title function_\">toBeInTheDocument</span>();\n  <span class=\"hljs-keyword\">await</span> expect.<span class=\"hljs-title function_\">element</span>(img).<span class=\"hljs-title function_\">toHaveAttribute</span>(<span class=\"hljs-string\">&quot;src&quot;</span>, src);\n  <span class=\"hljs-keyword\">await</span> expect.<span class=\"hljs-title function_\">element</span>(img).<span class=\"hljs-title function_\">toHaveAttribute</span>(<span class=\"hljs-string\">&quot;alt&quot;</span>, name);\n});\n</code></pre><ul>\n<li><code>render</code> will take a React component and render it in a vacuum. You can then poke and prod it as you need to test it.</li>\n<li>A big part of what Playwright and vitest-browser-react want you to do is not test implementation details but to test actual user experiences. Don&#39;t test the internal state of a React component but do test what users will see and experience. As such, a lot of we&#39;ll be testing will be around roles, attributes, etc.</li>\n<li><a href=\"https://testing-library.com/docs/guiding-principles\">@testing-library</a> has a good doc on why they choose to test this way.</li>\n<li>In general, vitest-browser-react aims to be a drop in replacement for @testing-library/react.</li>\n</ul>\n<p>Looks really similar, right? Alright, let&#39;s run it. <code>npm run test</code>. You should see the same Vitest UI but now some of the tests are actually running in the browser.</p>\n<blockquote>\n<p>It will likely prompt you to run a command like <code>npx playwright install</code>. You&#39;ll install local copies of browsers to able to run them super fast.</p>\n</blockquote>\n<p>Cool, right? And really fast! Let&#39;s do one more. Let&#39;s make a <code>Header.jsx</code> test. We&#39;re going to test that the cart number is correct. Remember when Facebook notification numbers were always wrong? We&#39;re going to make sure that doesn&#39;t happen with our cart indicator. In your Header.jsx file:</p>\n<pre><code class=\"hljs language-javascript\">data-testid=<span class=\"hljs-string\">&quot;cart-number&quot;</span> <span class=\"hljs-comment\">// add to .nav-cart-number</span>\n</code></pre><p>Now make a Header.browser.test.jsx</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { render } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest-browser-react&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { expect, test } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;vitest&quot;</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Header</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../Header&quot;</span>;\n<span class=\"hljs-keyword\">import</span> {\n  <span class=\"hljs-title class_\">RouterProvider</span>,\n  createRouter,\n  createRootRoute,\n} <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@tanstack/react-router&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">CartContext</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../contexts&quot;</span>;\n\n<span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;correctly renders a header with a zero cart count&quot;</span>, <span class=\"hljs-title function_\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> rootRoute = <span class=\"hljs-title function_\">createRootRoute</span>({\n    <span class=\"hljs-attr\">component</span>: <span class=\"hljs-function\">() =&gt;</span> (\n      <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">CartContext.Provider</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{[[]]}</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Header</span> /&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">CartContext.Provider</span>&gt;</span></span>\n    ),\n  });\n\n  <span class=\"hljs-keyword\">const</span> router = <span class=\"hljs-title function_\">createRouter</span>({ <span class=\"hljs-attr\">routeTree</span>: rootRoute });\n  <span class=\"hljs-keyword\">const</span> screen = <span class=\"hljs-title function_\">render</span>(<span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">RouterProvider</span> <span class=\"hljs-attr\">router</span>=<span class=\"hljs-string\">{router}</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">RouterProvider</span>&gt;</span></span>);\n\n  <span class=\"hljs-keyword\">const</span> itemsInCart = <span class=\"hljs-keyword\">await</span> screen.<span class=\"hljs-title function_\">getByTestId</span>(<span class=\"hljs-string\">&quot;cart-number&quot;</span>);\n\n  <span class=\"hljs-keyword\">await</span> expect.<span class=\"hljs-title function_\">element</span>(itemsInCart).<span class=\"hljs-title function_\">toBeInTheDocument</span>();\n  <span class=\"hljs-keyword\">await</span> expect.<span class=\"hljs-title function_\">element</span>(itemsInCart).<span class=\"hljs-title function_\">toHaveTextContent</span>(<span class=\"hljs-string\">&quot;0&quot;</span>);\n});\n\n<span class=\"hljs-title function_\">test</span>(<span class=\"hljs-string\">&quot;correctly renders a header with a three cart count&quot;</span>, <span class=\"hljs-title function_\">async</span> () =&gt; {\n  <span class=\"hljs-keyword\">const</span> rootRoute = <span class=\"hljs-title function_\">createRootRoute</span>({\n    <span class=\"hljs-attr\">component</span>: <span class=\"hljs-function\">() =&gt;</span> (\n      <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">CartContext.Provider</span>\n        <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">{[[{</span> <span class=\"hljs-attr\">pizza:</span> <span class=\"hljs-attr\">1</span> }, { <span class=\"hljs-attr\">pizza:</span> <span class=\"hljs-attr\">2</span> }, { <span class=\"hljs-attr\">pizza:</span> <span class=\"hljs-attr\">3</span> }]]}\n      &gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Header</span> /&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">CartContext.Provider</span>&gt;</span></span>\n    ),\n  });\n\n  <span class=\"hljs-keyword\">const</span> router = <span class=\"hljs-title function_\">createRouter</span>({ <span class=\"hljs-attr\">routeTree</span>: rootRoute });\n  <span class=\"hljs-keyword\">const</span> screen = <span class=\"hljs-title function_\">render</span>(<span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">RouterProvider</span> <span class=\"hljs-attr\">router</span>=<span class=\"hljs-string\">{router}</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">RouterProvider</span>&gt;</span></span>);\n\n  <span class=\"hljs-keyword\">const</span> itemsInCart = <span class=\"hljs-keyword\">await</span> screen.<span class=\"hljs-title function_\">getByTestId</span>(<span class=\"hljs-string\">&quot;cart-number&quot;</span>);\n\n  <span class=\"hljs-keyword\">await</span> expect.<span class=\"hljs-title function_\">element</span>(itemsInCart).<span class=\"hljs-title function_\">toBeInTheDocument</span>();\n  <span class=\"hljs-keyword\">await</span> expect.<span class=\"hljs-title function_\">element</span>(itemsInCart).<span class=\"hljs-title function_\">toHaveTextContent</span>(<span class=\"hljs-string\">&quot;3&quot;</span>);\n});\n</code></pre><p>We do have to bend over a bit backwards to make sure TanStack Router is happy, hence all the making of root routes. Remember also that our cart gets its cart from context so we have to pass it in that way. Beyond that, it works very similar!</p>\n<p>Again, these are early days for browser-based testing with Vite so proceed in your professional settings with caution. However the future is bright with Playwright!</p>\n<blockquote>\n<p>üö® NOTE: If you want to add code coverage back into the project, you&#39;ll need to use Istanbul since, at the time of this recording, this wasn&#39;t supported in React 19 with V8</p>\n</blockquote>\n<p>First, you&#39;ll need to uninstall V8 and install Istanbul:</p>\n<pre><code class=\"hljs language-bash\">npm uninstall @vitest/coverage-v8@2.1.3\nnpm install -D @vitest/istanbul\n</code></pre><p>Then move the coverage configuration to the <code>vitest.workspace.js</code> file:</p>\n<pre><code class=\"hljs language-javascript\">\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-title function_\">defineWorkspace</span>([\n  {\n    <span class=\"hljs-attr\">extends</span>: <span class=\"hljs-string\">&quot;./vite.config.js&quot;</span>,\n    <span class=\"hljs-attr\">test</span>: {\n      <span class=\"hljs-comment\">// ...</span>\n      <span class=\"hljs-comment\">// add to the end of the happy-dom test object </span>\n      <span class=\"hljs-attr\">coverage</span>: {\n        <span class=\"hljs-attr\">provider</span>: <span class=\"hljs-string\">&quot;istanbul&quot;</span>\n        <span class=\"hljs-attr\">reporter</span>: [<span class=\"hljs-string\">&quot;text&quot;</span>, <span class=\"hljs-string\">&quot;json&quot;</span>, <span class=\"hljs-string\">&quot;html&quot;</span>],\n      },\n    },\n  },\n  {\n    <span class=\"hljs-attr\">extends</span>: <span class=\"hljs-string\">&quot;./vite.config.js&quot;</span>,\n    <span class=\"hljs-attr\">test</span>: {\n      <span class=\"hljs-comment\">// ...</span>\n      <span class=\"hljs-comment\">// add to the end of the browser test object </span>\n      <span class=\"hljs-attr\">coverage</span>: {\n        <span class=\"hljs-attr\">reporter</span>: [<span class=\"hljs-string\">&quot;text&quot;</span>, <span class=\"hljs-string\">&quot;json&quot;</span>, <span class=\"hljs-string\">&quot;html&quot;</span>],\n      },\n    },\n  },\n]);\n</code></pre><blockquote>\n<p>üèÅ <a href=\"https://github.com/btholt/citr-v9-project/tree/master/14-testing\">Click here to see the state of the project up until now: 14-testing</a></p>\n</blockquote>\n","markdown":"\n> üö® This is experimental and very likely to change in the future. Consider this a sneak peak into what is coming, not what to do today.\n\nVitest is beginning to support more deeply browser-based testing. To those of us that have been around long enough to remember Selenium, this may strike fear deep int your heart. But fear not! Browser-based testing tools have come so far along since then that it's both fast and reliable, in particular thanks to the Microsoft project [Playwright][playwright].\n\nHowever this is still early days. I'm going to show you how to set it up but be warned that this prone to change as they're still actively working on it!\n\nSo first let's install the libraries we need.\n\n```bash\nnpm i -D @vitest/browser@2.1.3 playwright@1.48.0 vitest-browser-react@0.0.1\n```\n\nYou can see that the vitest-browser-react library is still 0.0.1 as of writing so be extra aware it's likely to have changed by the time you read this.\n\nOkay, so now we want to write browser based tests. But we have also have a bunch of existing Node.js-based tests. Some our already-existing Node.js based tests won't work in the browser. But no worries, Vitest/Vite has a tool just for this, workspaces. It's actually made to handle monorepos, but it will work here just as well. Make a file called `vitest.workspace.js` (you don't normally need this as your Vite config is normally enough.)\n\n```javascript\nimport { defineWorkspace } from \"vitest/config\";\n\nexport default defineWorkspace([\n  {\n    extends: \"./vite.config.js\",\n    test: {\n      include: [\"**/*.node.test.{js,jsx}\"],\n      name: \"happy-dom\",\n      environment: \"happy-dom\",\n    },\n  },\n  {\n    extends: \"./vite.config.js\",\n    test: {\n      setupFiles: [\"vitest-browser-react\"],\n      include: [\"**/*.browser.test.{js,jsx}\"],\n      name: \"browser\",\n      browser: {\n        provider: \"playwright\",\n        enabled: true,\n        name: \"firefox\", // you can use chromium or webkit here too\n      },\n    },\n  },\n]);\n```\n\nNow delete the `test` items from your vite.config.js file.\n\nThis is a test-only config for Vite (and therefore Vitest.) Now if a test ends in `.node.test.jsx` it will run through the happy-dom based environment and if it ends in `.browser.test.jsx` it will run in our new browser-based environment with Playwright. Let's go rename our tests to reflect that.\n\n- Cart.browser.test.jsx\n- contact.lazy.node.test.jsx\n- Pizza.node.test.jsx\n- usePizzaOfTheDay.node.test.jsx\n\nSnapshotting works in the browser so that one works okay. Anything using vitest-fetch-mock is Node.js only so for those we need to mark them as node. We're going to make a new Pizza file so let's leave that one. And our custom hook test mocks fetch so that one is Node only.\n\nOkay, now create a `Pizza.browser.test.jsx`\n\n```javascript\nimport { render } from \"vitest-browser-react\";\nimport { expect, test } from \"vitest\";\nimport Pizza from \"../Pizza\";\n\ntest(\"alt text renders on image\", async () => {\n  const name = \"My Favorite Pizza\";\n  const src = \"https://picsum.photos/200\";\n  const screen = render(\n    <Pizza name={name} description=\"super cool pizza\" image={src} />\n  );\n\n  const img = await screen.getByRole(\"img\");\n\n  await expect.element(img).toBeInTheDocument();\n  await expect.element(img).toHaveAttribute(\"src\", src);\n  await expect.element(img).toHaveAttribute(\"alt\", name);\n});\n```\n\n- `render` will take a React component and render it in a vacuum. You can then poke and prod it as you need to test it.\n- A big part of what Playwright and vitest-browser-react want you to do is not test implementation details but to test actual user experiences. Don't test the internal state of a React component but do test what users will see and experience. As such, a lot of we'll be testing will be around roles, attributes, etc.\n- [@testing-library][principles] has a good doc on why they choose to test this way.\n- In general, vitest-browser-react aims to be a drop in replacement for @testing-library/react.\n\nLooks really similar, right? Alright, let's run it. `npm run test`. You should see the same Vitest UI but now some of the tests are actually running in the browser.\n\n> It will likely prompt you to run a command like `npx playwright install`. You'll install local copies of browsers to able to run them super fast.\n\nCool, right? And really fast! Let's do one more. Let's make a `Header.jsx` test. We're going to test that the cart number is correct. Remember when Facebook notification numbers were always wrong? We're going to make sure that doesn't happen with our cart indicator. In your Header.jsx file:\n\n```javascript\ndata-testid=\"cart-number\" // add to .nav-cart-number\n```\n\nNow make a Header.browser.test.jsx\n\n```javascript\nimport { render } from \"vitest-browser-react\";\nimport { expect, test } from \"vitest\";\nimport Header from \"../Header\";\nimport {\n  RouterProvider,\n  createRouter,\n  createRootRoute,\n} from \"@tanstack/react-router\";\nimport { CartContext } from \"../contexts\";\n\ntest(\"correctly renders a header with a zero cart count\", async () => {\n  const rootRoute = createRootRoute({\n    component: () => (\n      <CartContext.Provider value={[[]]}>\n        <Header />\n      </CartContext.Provider>\n    ),\n  });\n\n  const router = createRouter({ routeTree: rootRoute });\n  const screen = render(<RouterProvider router={router}></RouterProvider>);\n\n  const itemsInCart = await screen.getByTestId(\"cart-number\");\n\n  await expect.element(itemsInCart).toBeInTheDocument();\n  await expect.element(itemsInCart).toHaveTextContent(\"0\");\n});\n\ntest(\"correctly renders a header with a three cart count\", async () => {\n  const rootRoute = createRootRoute({\n    component: () => (\n      <CartContext.Provider\n        value={[[{ pizza: 1 }, { pizza: 2 }, { pizza: 3 }]]}\n      >\n        <Header />\n      </CartContext.Provider>\n    ),\n  });\n\n  const router = createRouter({ routeTree: rootRoute });\n  const screen = render(<RouterProvider router={router}></RouterProvider>);\n\n  const itemsInCart = await screen.getByTestId(\"cart-number\");\n\n  await expect.element(itemsInCart).toBeInTheDocument();\n  await expect.element(itemsInCart).toHaveTextContent(\"3\");\n});\n```\n\nWe do have to bend over a bit backwards to make sure TanStack Router is happy, hence all the making of root routes. Remember also that our cart gets its cart from context so we have to pass it in that way. Beyond that, it works very similar!\n\nAgain, these are early days for browser-based testing with Vite so proceed in your professional settings with caution. However the future is bright with Playwright!\n\n> üö® NOTE: If you want to add code coverage back into the project, you'll need to use Istanbul since, at the time of this recording, this wasn't supported in React 19 with V8\n\nFirst, you'll need to uninstall V8 and install Istanbul:\n\n```bash\nnpm uninstall @vitest/coverage-v8@2.1.3\nnpm install -D @vitest/istanbul\n```\nThen move the coverage configuration to the `vitest.workspace.js` file:\n\n```javascript\n\nexport default defineWorkspace([\n  {\n    extends: \"./vite.config.js\",\n    test: {\n      // ...\n      // add to the end of the happy-dom test object \n      coverage: {\n        provider: \"istanbul\"\n        reporter: [\"text\", \"json\", \"html\"],\n      },\n    },\n  },\n  {\n    extends: \"./vite.config.js\",\n    test: {\n      // ...\n      // add to the end of the browser test object \n      coverage: {\n        reporter: [\"text\", \"json\", \"html\"],\n      },\n    },\n  },\n]);\n```\n\n\n\n> üèÅ [Click here to see the state of the project up until now: 14-testing][step]\n\n[step]: https://github.com/btholt/citr-v9-project/tree/master/14-testing\n[principles]: https://testing-library.com/docs/guiding-principles\n[playwright]: https://playwright.dev/\n","slug":"browser-tests","title":"Browser Tests","section":"Testing","icon":"vial","filePath":"/home/runner/work/complete-intro-to-react-v9/complete-intro-to-react-v9/lessons/07-testing/H-browser-tests.md","nextSlug":"/lessons/whats-next/react-19","prevSlug":"/lessons/testing/vitest-ui"}},"__N_SSG":true}