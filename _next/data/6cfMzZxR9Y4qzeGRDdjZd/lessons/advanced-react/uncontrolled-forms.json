{"pageProps":{"post":{"attributes":{"description":"Learn how to create a contact page using TanStack Query in React with Brian Holt's Complete Intro to React, v9. Discover how to handle posts via mutations, manage uncontrolled forms, and integrate these features seamlessly into your React application.","keywords":["React contact page","TanStack Query","uncontrolled forms","React","Brian Holt"]},"html":"<h2>Uncontrolled Forms</h2>\n<p>We are now going to do a contact page for our site. As part of that, we will accept a name, email, and message from our users and submit it our backend. Like all good backends, ours will log it to the console and then ignore it.</p>\n<p>We are going to see two new concepts here: how to do a post with TanStack Query (which they call a mutation) and how to do uncontrolled forms with React. Let&#39;s start with our API query. In src/api, create a file called <code>postContact.js</code> and put this in there.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">postContact</span>(<span class=\"hljs-params\">name, email, message</span>) {\n  <span class=\"hljs-keyword\">const</span> response = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-string\">&quot;/api/contact&quot;</span>, {\n    <span class=\"hljs-attr\">method</span>: <span class=\"hljs-string\">&quot;POST&quot;</span>,\n    <span class=\"hljs-attr\">headers</span>: {\n      <span class=\"hljs-string\">&quot;Content-Type&quot;</span>: <span class=\"hljs-string\">&quot;application/json&quot;</span>,\n    },\n    <span class=\"hljs-attr\">body</span>: <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>({ name, email, message }),\n  });\n\n  <span class=\"hljs-keyword\">if</span> (!response.<span class=\"hljs-property\">ok</span>) {\n    <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&quot;Network response was not ok&quot;</span>);\n  }\n\n  <span class=\"hljs-keyword\">return</span> response.<span class=\"hljs-title function_\">json</span>();\n}\n</code></pre><p>Create a new link to our page in index.lazy.jsx</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">// after past orders</span>\n&lt;li&gt;\n  <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Link</span> <span class=\"hljs-attr\">to</span>=<span class=\"hljs-string\">&quot;/contact&quot;</span>&gt;</span>Contact<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Link</span>&gt;</span></span>\n&lt;/li&gt;\n</code></pre><p>Create a new route called <code>contact.lazy.jsx</code> in <code>src/routes</code></p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { createLazyFileRoute } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@tanstack/react-router&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { useMutation } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@tanstack/react-query&quot;</span>;\n<span class=\"hljs-keyword\">import</span> postContact <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;../api/postContact&quot;</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Route</span> = <span class=\"hljs-title function_\">createLazyFileRoute</span>(<span class=\"hljs-string\">&quot;/contact&quot;</span>)({\n  <span class=\"hljs-attr\">component</span>: <span class=\"hljs-title class_\">ContactRoute</span>,\n});\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">ContactRoute</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> mutation = <span class=\"hljs-title function_\">useMutation</span>({\n    <span class=\"hljs-attr\">mutationFn</span>: <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">e</span>) {\n      e.<span class=\"hljs-title function_\">preventDefault</span>();\n      <span class=\"hljs-keyword\">const</span> formData = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FormData</span>(e.<span class=\"hljs-property\">target</span>);\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">postContact</span>(\n        formData.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;name&quot;</span>),\n        formData.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;email&quot;</span>),\n        formData.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;message&quot;</span>)\n      );\n    },\n  });\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;contact&quot;</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h2</span>&gt;</span>Contact<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h2</span>&gt;</span>\n      {mutation.isSuccess ? (\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">h3</span>&gt;</span>Submitted!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">h3</span>&gt;</span>\n      ) : (\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">form</span> <span class=\"hljs-attr\">onSubmit</span>=<span class=\"hljs-string\">{mutation.mutate}</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;name&quot;</span> <span class=\"hljs-attr\">placeholder</span>=<span class=\"hljs-string\">&quot;Name&quot;</span> /&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;email&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;email&quot;</span> <span class=\"hljs-attr\">placeholder</span>=<span class=\"hljs-string\">&quot;Email&quot;</span> /&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">textarea</span> <span class=\"hljs-attr\">placeholder</span>=<span class=\"hljs-string\">&quot;Message&quot;</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;message&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">textarea</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span>&gt;</span>Submit<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">form</span>&gt;</span>\n      )}\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>\n  );\n}\n</code></pre><ul>\n<li>We are using a mutation from TanStack React Query. It works very similar to normal gets except this one sends information to the API instead of gets it.</li>\n<li>Notice we&#39;re using <code>isSuccess</code> to show or hide the form. Once the mutation has successfully been submitted, we just want to show them that and then hide the form.</li>\n<li>Notice we&#39;re not using state or useState at all here. We&#39;re using an &quot;uncontrolled&quot; form which just means we&#39;re letting the DOM manage the state. Only on a submit event are we reading from the DOM using the FormData API. We use that to submit to our API the contact data.</li>\n<li>There&#39;s also isError and isIdle, we just didn&#39;t use them from TanStack Query.</li>\n<li>Also notice in the dev tools for TanStack Query the mutations (it&#39;s in another tab.)</li>\n</ul>\n<p>Try it! You&#39;ll notice in the logs of where-ever your API is running that it logs out the contact info.</p>\n<blockquote>\n<p>üèÅ <a href=\"https://github.com/btholt/citr-v9-project/tree/master/13-uncontrolled-forms\">Click here to see the state of the project up until now: 13-uncontrolled-forms</a></p>\n</blockquote>\n","markdown":"\n## Uncontrolled Forms\n\nWe are now going to do a contact page for our site. As part of that, we will accept a name, email, and message from our users and submit it our backend. Like all good backends, ours will log it to the console and then ignore it.\n\nWe are going to see two new concepts here: how to do a post with TanStack Query (which they call a mutation) and how to do uncontrolled forms with React. Let's start with our API query. In src/api, create a file called `postContact.js` and put this in there.\n\n```javascript\nexport default async function postContact(name, email, message) {\n  const response = await fetch(\"/api/contact\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ name, email, message }),\n  });\n\n  if (!response.ok) {\n    throw new Error(\"Network response was not ok\");\n  }\n\n  return response.json();\n}\n```\n\nCreate a new link to our page in index.lazy.jsx\n\n```javascript\n// after past orders\n<li>\n  <Link to=\"/contact\">Contact</Link>\n</li>\n```\n\nCreate a new route called `contact.lazy.jsx` in `src/routes`\n\n```javascript\nimport { createLazyFileRoute } from \"@tanstack/react-router\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport postContact from \"../api/postContact\";\n\nexport const Route = createLazyFileRoute(\"/contact\")({\n  component: ContactRoute,\n});\n\nfunction ContactRoute() {\n  const mutation = useMutation({\n    mutationFn: function (e) {\n      e.preventDefault();\n      const formData = new FormData(e.target);\n      return postContact(\n        formData.get(\"name\"),\n        formData.get(\"email\"),\n        formData.get(\"message\")\n      );\n    },\n  });\n\n  return (\n    <div className=\"contact\">\n      <h2>Contact</h2>\n      {mutation.isSuccess ? (\n        <h3>Submitted!</h3>\n      ) : (\n        <form onSubmit={mutation.mutate}>\n          <input name=\"name\" placeholder=\"Name\" />\n          <input type=\"email\" name=\"email\" placeholder=\"Email\" />\n          <textarea placeholder=\"Message\" name=\"message\"></textarea>\n          <button>Submit</button>\n        </form>\n      )}\n    </div>\n  );\n}\n```\n\n- We are using a mutation from TanStack React Query. It works very similar to normal gets except this one sends information to the API instead of gets it.\n- Notice we're using `isSuccess` to show or hide the form. Once the mutation has successfully been submitted, we just want to show them that and then hide the form.\n- Notice we're not using state or useState at all here. We're using an \"uncontrolled\" form which just means we're letting the DOM manage the state. Only on a submit event are we reading from the DOM using the FormData API. We use that to submit to our API the contact data.\n- There's also isError and isIdle, we just didn't use them from TanStack Query.\n- Also notice in the dev tools for TanStack Query the mutations (it's in another tab.)\n\nTry it! You'll notice in the logs of where-ever your API is running that it logs out the contact info.\n\n> üèÅ [Click here to see the state of the project up until now: 13-uncontrolled-forms][step]\n\n[step]: https://github.com/btholt/citr-v9-project/tree/master/13-uncontrolled-forms\n","slug":"uncontrolled-forms","title":"Uncontrolled Forms","section":"Advanced React","icon":"dumbbell","filePath":"/home/runner/work/complete-intro-to-react-v9/complete-intro-to-react-v9/lessons/06-advanced-react/C-uncontrolled-forms.md","nextSlug":"/lessons/testing/vitest","prevSlug":"/lessons/advanced-react/error-boundaries"}},"__N_SSG":true}